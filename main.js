/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CardNavigatorPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/ui/cardNavigator.ts
var import_obsidian5 = require("obsidian");

// src/ui/toolbar/toolbar.ts
var import_obsidian2 = require("obsidian");

// src/ui/toolbar/toolbarActions.ts
var import_obsidian = require("obsidian");
var FolderSuggestModal = class extends import_obsidian.FuzzySuggestModal {
  constructor(plugin, onSelect) {
    super(plugin.app);
    this.plugin = plugin;
    this.onSelect = onSelect;
  }
  getItems() {
    return this.plugin.app.vault.getAllLoadedFiles().filter((file) => file instanceof import_obsidian.TFolder);
  }
  getItemText(folder) {
    return folder.path;
  }
  onChooseItem(folder) {
    this.onSelect(folder);
  }
};
function toggleSort(plugin) {
  let sortPopup = document.querySelector(".card-navigator-sort-popup");
  if (!sortPopup) {
    sortPopup = document.createElement("div");
    sortPopup.className = "card-navigator-sort-popup";
    const currentSort = `${plugin.settings.sortCriterion}_${plugin.settings.sortOrder}`;
    const addSortOption = (value, label) => {
      const option = document.createElement("button");
      option.textContent = label;
      option.classList.toggle("active", currentSort === value);
      option.addEventListener("click", async () => {
        const [criterion, order] = value.split("_");
        plugin.settings.sortCriterion = criterion;
        plugin.settings.sortOrder = order;
        await plugin.saveSettings();
        plugin.triggerRefresh();
        sortPopup.remove();
      });
      sortPopup.appendChild(option);
    };
    addSortOption("fileName_asc", "File name (A to Z)");
    addSortOption("fileName_desc", "File name (Z to A)");
    addSortOption("lastModified_desc", "Last modified (newest first)");
    addSortOption("lastModified_asc", "Last modified (oldest first)");
    addSortOption("created_desc", "Created (newest first)");
    addSortOption("created_asc", "Created (oldest first)");
    const toolbarEl = document.querySelector(".card-navigator-toolbar-container");
    if (toolbarEl) {
      toolbarEl.insertAdjacentElement("afterend", sortPopup);
      document.addEventListener("click", function onClickOutside(event) {
        if (sortPopup && !sortPopup.contains(event.target) && !toolbarEl.contains(event.target)) {
          sortPopup.remove();
          document.removeEventListener("click", onClickOutside);
        }
      });
    }
  } else {
    sortPopup.remove();
  }
}
function toggleSettings(plugin) {
  let settingsPopup = document.querySelector(".card-navigator-settings-popup");
  if (!settingsPopup) {
    settingsPopup = document.createElement("div");
    settingsPopup.className = "card-navigator-settings-popup";
    const updateSetting = async (settingKey, value) => {
      plugin.settings[settingKey] = value;
      await plugin.saveSettings();
      plugin.triggerRefresh();
    };
    const cardsPerViewSetting = document.createElement("input");
    cardsPerViewSetting.type = "range";
    cardsPerViewSetting.min = "1";
    cardsPerViewSetting.max = "10";
    cardsPerViewSetting.value = plugin.settings.cardsPerView.toString();
    cardsPerViewSetting.addEventListener("input", (e) => {
      const value = parseInt(e.target.value, 10);
      updateSetting("cardsPerView", value);
    });
    const cardsPerViewLabel = document.createElement("label");
    cardsPerViewLabel.textContent = "Cards Per View:";
    settingsPopup.appendChild(cardsPerViewLabel);
    settingsPopup.appendChild(cardsPerViewSetting);
    const fontSizeSetting = document.createElement("input");
    fontSizeSetting.type = "range";
    fontSizeSetting.min = "10";
    fontSizeSetting.max = "30";
    fontSizeSetting.value = plugin.settings.contentSize.toString();
    fontSizeSetting.addEventListener("input", (e) => {
      const value = parseInt(e.target.value, 10);
      updateSetting("contentSize", value);
    });
    const fontSizeLabel = document.createElement("label");
    fontSizeLabel.textContent = "Content Font Size:";
    settingsPopup.appendChild(fontSizeLabel);
    settingsPopup.appendChild(fontSizeSetting);
    const createToggle = (labelText, settingKey) => {
      const container = document.createElement("div");
      const label = document.createElement("label");
      label.textContent = labelText;
      const toggle = document.createElement("input");
      toggle.type = "checkbox";
      toggle.checked = plugin.settings[settingKey];
      toggle.addEventListener("change", (e) => {
        updateSetting(settingKey, e.target.checked);
      });
      container.appendChild(label);
      container.appendChild(toggle);
      return container;
    };
    const fileNameToggle = createToggle("Show File Name", "showFileName");
    settingsPopup.appendChild(fileNameToggle);
    const firstHeaderToggle = createToggle("Show First Header", "showFirstHeader");
    settingsPopup.appendChild(firstHeaderToggle);
    const contentToggle = createToggle("Show Content", "showContent");
    settingsPopup.appendChild(contentToggle);
    const dragDropContentToggle = createToggle("Drag and Drop Content", "dragDropContent");
    settingsPopup.appendChild(dragDropContentToggle);
    const toolbarEl = document.querySelector(".card-navigator-toolbar-container");
    if (toolbarEl) {
      toolbarEl.insertAdjacentElement("afterend", settingsPopup);
      document.addEventListener("click", function onClickOutside(event) {
        if (settingsPopup && !settingsPopup.contains(event.target) && !toolbarEl.contains(event.target)) {
          settingsPopup.remove();
          document.removeEventListener("click", onClickOutside);
        }
      });
    }
  } else {
    settingsPopup.classList.toggle("hidden");
  }
}

// src/ui/toolbar/toolbar.ts
var Toolbar = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.containerEl = void 0;
    this.isVertical = false;
  }
  initialize(containerEl) {
    this.containerEl = containerEl;
    this.createToolbar();
  }
  setOrientation(isVertical) {
    if (this.isVertical !== isVertical) {
      this.isVertical = isVertical;
      this.updateToolbarStyle();
      this.createToolbar();
    }
  }
  updateToolbarStyle() {
    if (this.containerEl) {
      this.containerEl.classList.toggle("vertical", this.isVertical);
      this.containerEl.classList.toggle("horizontal", !this.isVertical);
    }
  }
  createToolbar() {
    if (!this.containerEl) {
      return;
    }
    this.containerEl.empty();
    const toolbarContainer = document.createElement("div");
    toolbarContainer.className = "card-navigator-toolbar-container";
    const searchContainer = this.createSearchContainer();
    const separator = this.createSeparator();
    const actionIconsContainer = this.createActionIconsContainer();
    toolbarContainer.appendChild(searchContainer);
    toolbarContainer.appendChild(separator);
    toolbarContainer.appendChild(actionIconsContainer);
    this.containerEl.appendChild(toolbarContainer);
  }
  createSearchContainer() {
    const container = document.createElement("div");
    container.className = "card-navigator-search-container";
    const input = document.createElement("input");
    input.type = "text";
    input.placeholder = "Search...";
    input.className = "card-navigator-search-input";
    input.addEventListener("input", (0, import_obsidian2.debounce)(async (e) => {
      const searchTerm = e.target.value;
      const view = this.plugin.app.workspace.getLeavesOfType("card-navigator-view")[0].view;
      await view.cardContainer.searchCards(searchTerm);
    }, 300));
    container.appendChild(input);
    return container;
  }
  createActionIconsContainer() {
    const container = document.createElement("div");
    container.className = "card-navigator-action-icons-container";
    const icons = [
      { name: "folder", label: "Select folder", action: () => this.openFolderSelector() },
      { name: "arrow-up-narrow-wide", label: "Sort cards", action: () => toggleSort(this.plugin) },
      { name: "settings", label: "Settings", action: () => toggleSettings(this.plugin) }
    ];
    icons.forEach((icon) => {
      const iconElement = this.createToolbarIcon(icon.name, icon.label, icon.action);
      if (icon.name === "arrow-up-narrow-wide") {
        iconElement.classList.toggle(
          "active",
          this.plugin.settings.sortCriterion !== "fileName" || this.plugin.settings.sortOrder !== "asc"
        );
      }
      container.appendChild(iconElement);
    });
    return container;
  }
  createToolbarIcon(iconName, ariaLabel, action) {
    const icon = document.createElement("div");
    icon.className = "clickable-icon";
    icon.setAttribute("aria-label", ariaLabel);
    (0, import_obsidian2.setIcon)(icon, iconName);
    icon.addEventListener("click", action);
    return icon;
  }
  createSeparator() {
    const separator = document.createElement("div");
    separator.className = "toolbar-separator";
    return separator;
  }
  openFolderSelector() {
    new FolderSuggestModal(this.plugin, (folder) => {
      const view = this.plugin.app.workspace.getActiveViewOfType(CardNavigator);
      if (view) {
        view.cardContainer.displayCardsForFolder(folder);
      }
    }).open();
  }
  refresh() {
  }
  onClose() {
  }
};

// src/ui/cardContainer/cardContainer.ts
var import_obsidian4 = require("obsidian");

// src/ui/cardContainer/cardMaker.ts
var import_obsidian3 = require("obsidian");

// src/common/utils.ts
function separateFrontmatterAndContent(content) {
  const frontmatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n/;
  const match = content.match(frontmatterRegex);
  return match ? { frontmatter: match[1], cleanContent: content.slice(match[0].length).trim() } : { frontmatter: null, cleanContent: content.trim() };
}
function sortFiles(files, criterion, order) {
  return files.sort((a, b) => {
    let comparison = 0;
    switch (criterion) {
      case "fileName":
        comparison = a.basename.localeCompare(b.basename, void 0, { numeric: true, sensitivity: "base" });
        break;
      case "lastModified":
        comparison = a.stat.mtime - b.stat.mtime;
        break;
      case "created":
        comparison = a.stat.ctime - b.stat.ctime;
        break;
    }
    return order === "asc" ? comparison : -comparison;
  });
}

// src/ui/cardContainer/cardMaker.ts
var CardMaker = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  async getCardsForActiveFile(activeFile) {
    const folder = activeFile.parent;
    if (!folder) {
      return [];
    }
    const files = folder.children.filter((file) => file instanceof import_obsidian3.TFile);
    const sortedFiles = sortFiles(
      files,
      this.plugin.settings.sortCriterion,
      this.plugin.settings.sortOrder
    );
    return await Promise.all(sortedFiles.map((file) => this.createCard(file)));
  }
  async createCard(file) {
    const content = await this.plugin.app.vault.cachedRead(file);
    const { cleanContent } = separateFrontmatterAndContent(content);
    const contentWithoutHeader = this.removeFirstHeader(cleanContent);
    return {
      file,
      fileName: this.plugin.settings.showFileName ? file.basename : void 0,
      firstHeader: this.plugin.settings.showFirstHeader ? this.findFirstHeader(cleanContent) : void 0,
      content: this.plugin.settings.showContent ? this.truncateContent(contentWithoutHeader) : void 0
    };
  }
  removeFirstHeader(content) {
    const headerRegex = /^#+\s+(.+)$/m;
    return content.replace(headerRegex, "").trim();
  }
  findFirstHeader(content) {
    const headerRegex = /^#+\s+(.+)$/m;
    const match = content.match(headerRegex);
    return match ? match[1].trim() : void 0;
  }
  truncateContent(content) {
    const maxLength = this.plugin.settings.contentLength * 100;
    return content.length <= maxLength ? content : content.slice(0, maxLength) + "...";
  }
  createCardElement(card) {
    const cardElement = document.createElement("div");
    cardElement.className = "card-navigator-card";
    if (this.plugin.settings.showFileName && card.fileName) {
      const fileNameEl = cardElement.createEl("h3", { text: card.fileName });
      fileNameEl.className = "card-navigator-filename";
      fileNameEl.style.fontSize = `${this.plugin.settings.fileNameSize}px`;
    }
    if (this.plugin.settings.showFirstHeader && card.firstHeader) {
      const headerEl = cardElement.createEl("h4", { text: card.firstHeader });
      headerEl.className = "card-navigator-first-header";
      headerEl.style.fontSize = `${this.plugin.settings.firstHeaderSize}px`;
    }
    if (this.plugin.settings.showContent && card.content) {
      const contentEl = cardElement.createEl("div");
      contentEl.className = "card-navigator-content";
      contentEl.style.fontSize = `${this.plugin.settings.contentSize}px`;
      if (this.plugin.settings.renderContentAsHtml) {
        import_obsidian3.MarkdownRenderer.render(
          this.plugin.app,
          card.content,
          contentEl,
          card.file.path,
          this.plugin
        );
      } else {
        contentEl.textContent = card.content;
        contentEl.style.overflow = "hidden";
        contentEl.style.textOverflow = "ellipsis";
        contentEl.style.display = "-webkit-box";
      }
    }
    if (this.plugin.app.workspace.getActiveFile() === card.file) {
      cardElement.addClass("card-navigator-active");
    }
    this.addCardInteractions(cardElement, card);
    return cardElement;
  }
  addCardInteractions(cardElement, card) {
    cardElement.addEventListener("click", () => this.openFile(card.file));
    this.setupDragAndDrop(cardElement, card);
    this.setupContextMenu(cardElement, card.file);
  }
  setupDragAndDrop(cardElement, card) {
    cardElement.setAttribute("draggable", "true");
    cardElement.addEventListener("dragstart", (event) => {
      if (event.dataTransfer) {
        let dragContent = "";
        if (this.plugin.settings.dragDropContent) {
          if (this.plugin.settings.showFileName && card.fileName) {
            dragContent += `## ${card.fileName}

`;
          }
          if (this.plugin.settings.showFirstHeader && card.firstHeader) {
            dragContent += `# ${card.firstHeader}

`;
          }
          if (this.plugin.settings.showContent && card.content) {
            dragContent += `${card.content}

`;
          }
          if (dragContent === "") {
            dragContent = `[[${card.file.name}]]`;
          }
        } else {
          dragContent = `[[${card.file.name}]]`;
        }
        event.dataTransfer.setData("text/plain", dragContent.trim());
        event.dataTransfer.setDragImage(cardElement, 0, 0);
      }
    });
  }
  setupContextMenu(cardElement, file) {
    cardElement.addEventListener("contextmenu", (e) => {
      e.preventDefault();
      const menu = new import_obsidian3.Menu();
      this.plugin.app.workspace.trigger("file-menu", menu, file, "more-options");
      menu.showAtPosition({ x: e.clientX, y: e.clientY });
    });
  }
  openFile(file) {
    this.plugin.app.workspace.getLeaf().openFile(file);
  }
};

// src/ui/cardContainer/cardContainer.ts
var CardContainer = class {
  constructor(plugin, leaf) {
    this.containerEl = null;
    this.plugin = plugin;
    this.leaf = leaf;
    this.cardMaker = new CardMaker(this.plugin);
    this.isVertical = false;
    this.toolbarHeight = this.getCSSVariable("--card-navigator-toolbar-height", 50);
    this.cardGap = this.getCSSVariable("--card-navigator-gap", 10);
    this.containerPadding = this.getCSSVariable("--card-navigator-container-padding", 10);
  }
  getCSSVariable(variableName, defaultValue) {
    const valueStr = getComputedStyle(document.documentElement).getPropertyValue(variableName).trim();
    return parseInt(valueStr) || defaultValue;
  }
  async initialize(containerEl) {
    this.containerEl = containerEl;
    await this.waitForLeafCreation();
    this.registerEvents();
    this.updateContainerStyle();
    this.refresh();
  }
  async waitForLeafCreation() {
    return new Promise((resolve) => {
      const checkLeaf = () => {
        if (this.containerEl && this.containerEl.getBoundingClientRect().width > 0 && this.containerEl.clientHeight > 0) {
          resolve();
        } else {
          requestAnimationFrame(checkLeaf);
        }
      };
      checkLeaf();
    });
  }
  registerEvents() {
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("active-leaf-change", () => {
        this.plugin.triggerRefresh();
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("modify", () => {
        this.plugin.triggerRefresh();
      })
    );
  }
  setOrientation(isVertical) {
    this.isVertical = isVertical;
    this.updateContainerStyle();
    this.refresh();
  }
  updateContainerStyle() {
    if (this.containerEl) {
      this.containerEl.classList.add("card-navigator-container");
      this.containerEl.classList.toggle("vertical", this.isVertical);
      this.containerEl.classList.toggle("horizontal", !this.isVertical);
      this.containerEl.classList.toggle("fixed-height", this.plugin.settings.fixedCardHeight);
      this.containerEl.classList.toggle("flexible-height", !this.plugin.settings.fixedCardHeight);
      this.containerEl.style.setProperty("--cards-per-view", this.plugin.settings.cardsPerView.toString());
      this.containerEl.style.setProperty("--card-navigator-gap", `${this.cardGap}px`);
      this.containerEl.style.setProperty("--card-navigator-toolbar-height", `${this.toolbarHeight}px`);
      if (this.isVertical) {
        this.containerEl.style.flexDirection = "column";
        this.containerEl.style.overflowY = "auto";
        this.containerEl.style.overflowX = "hidden";
        this.containerEl.style.height = `calc(100% - ${this.toolbarHeight}px)`;
        this.containerEl.style.marginTop = `${this.toolbarHeight}px`;
        this.containerEl.style.gap = `${this.cardGap}px`;
        this.containerEl.style.marginRight = `-10px`;
        this.containerEl.style.paddingRight = `${this.containerPadding}px`;
      } else {
        this.containerEl.style.flexDirection = "row";
        this.containerEl.style.overflowX = "auto";
        this.containerEl.style.overflowY = "hidden";
        this.containerEl.style.height = "100%";
        this.containerEl.style.marginTop = "0";
        this.containerEl.style.gap = `${this.cardGap}px`;
        this.containerEl.style.paddingTop = `${this.containerPadding}px`;
        this.containerEl.style.paddingBottom = `${this.containerPadding}px`;
      }
    }
  }
  async refresh() {
    let folder = null;
    if (this.plugin.settings.useSelectedFolder && this.plugin.settings.selectedFolder) {
      folder = this.plugin.app.vault.getAbstractFileByPath(this.plugin.settings.selectedFolder);
    } else {
      const activeFile = this.plugin.app.workspace.getActiveFile();
      folder = (activeFile == null ? void 0 : activeFile.parent) || null;
    }
    if (!folder || !this.containerEl) {
      return;
    }
    const files = folder.children.filter((file) => file instanceof import_obsidian4.TFile);
    const sortedFiles = sortFiles(files, this.plugin.settings.sortCriterion, this.plugin.settings.sortOrder);
    const cardsData = await Promise.all(sortedFiles.map((file) => this.cardMaker.createCard(file)));
    this.renderCards(cardsData);
  }
  renderCards(cardsData) {
    const containerEl = this.containerEl;
    if (!containerEl) return;
    const currentScrollTop = containerEl.scrollTop;
    const currentScrollLeft = containerEl.scrollLeft;
    const activeCardIndex = Array.from(containerEl.children).findIndex(
      (child) => child.classList.contains("card-navigator-active")
    );
    containerEl.innerHTML = "";
    const containerHeight = containerEl.clientHeight;
    const availableHeight = containerHeight - this.toolbarHeight;
    cardsData.forEach((cardData, index) => {
      const card = this.cardMaker.createCardElement(cardData);
      card.style.flexShrink = "0";
      if (this.isVertical) {
        card.style.width = "100%";
        if (this.plugin.settings.fixedCardHeight) {
          card.style.height = `${availableHeight / this.plugin.settings.cardsPerView}px`;
          card.style.overflow = "auto";
        } else {
          card.style.height = "auto";
          card.style.minHeight = `${availableHeight / this.plugin.settings.cardsPerView / 2}px`;
          card.style.maxHeight = `${availableHeight / 2}px`;
        }
      } else {
        card.style.width = `${100 / this.plugin.settings.cardsPerView}%`;
        card.style.height = "100%";
      }
      if (cardData.file === this.plugin.app.workspace.getActiveFile()) {
        card.classList.add("card-navigator-active");
      }
      containerEl.appendChild(card);
    });
    containerEl.scrollTop = currentScrollTop;
    containerEl.scrollLeft = currentScrollLeft;
    const newActiveCardIndex = Array.from(containerEl.children).findIndex(
      (child) => child.classList.contains("card-navigator-active")
    );
    if (activeCardIndex !== newActiveCardIndex && newActiveCardIndex !== -1) {
      this.scrollToActiveCard(false);
    }
  }
  scrollToActiveCard(animate = true) {
    if (!this.containerEl) return;
    const activeCard = this.containerEl.querySelector(".card-navigator-active");
    if (!activeCard) return;
    const containerRect = this.containerEl.getBoundingClientRect();
    const activeCardRect = activeCard.getBoundingClientRect();
    let offset = 0;
    let scrollProperty;
    if (this.isVertical) {
      const containerCenter = containerRect.top + containerRect.height / 2;
      const cardCenter = activeCardRect.top + activeCardRect.height / 2;
      offset = cardCenter - containerCenter;
      scrollProperty = "scrollTop";
    } else {
      const containerCenter = containerRect.left + containerRect.width / 2;
      const cardCenter = activeCardRect.left + activeCardRect.width / 2;
      offset = cardCenter - containerCenter;
      scrollProperty = "scrollLeft";
    }
    const threshold = 50;
    if (Math.abs(offset) < threshold) return;
    const newScrollPosition = this.containerEl[scrollProperty] + offset;
    if (animate) {
      const start = this.containerEl[scrollProperty];
      const change = newScrollPosition - start;
      const duration = 300;
      let startTime = null;
      const animateScroll = (currentTime) => {
        if (startTime === null) startTime = currentTime;
        const timeElapsed = currentTime - startTime;
        const progress = Math.min(timeElapsed / duration, 1);
        const easeProgress = 0.5 - Math.cos(progress * Math.PI) / 2;
        if (this.containerEl) {
          this.containerEl[scrollProperty] = start + change * easeProgress;
        }
        if (timeElapsed < duration && this.containerEl) {
          requestAnimationFrame(animateScroll);
        }
      };
      requestAnimationFrame(animateScroll);
    } else {
      this.containerEl[scrollProperty] = newScrollPosition;
    }
  }
  centerActiveCard() {
    this.scrollToActiveCard(true);
  }
  scrollUp(count = 1) {
    if (!this.containerEl) return;
    if (this.isVertical) {
      const scrollAmount = this.getCardHeight() * count;
      this.containerEl.scrollBy({ top: -scrollAmount, behavior: "smooth" });
    } else {
      const scrollAmount = this.getCardWidth() * count;
      this.containerEl.scrollBy({ left: -scrollAmount, behavior: "smooth" });
    }
  }
  scrollDown(count = 1) {
    if (!this.containerEl) return;
    if (this.isVertical) {
      const scrollAmount = this.getCardHeight() * count;
      this.containerEl.scrollBy({ top: scrollAmount, behavior: "smooth" });
    } else {
      const scrollAmount = this.getCardWidth() * count;
      this.containerEl.scrollBy({ left: scrollAmount, behavior: "smooth" });
    }
  }
  scrollLeft(count = 1) {
    if (!this.containerEl) return;
    const scrollAmount = this.getCardWidth() * count;
    this.containerEl.scrollBy({ left: -scrollAmount, behavior: "smooth" });
  }
  scrollRight(count = 1) {
    if (!this.containerEl) return;
    const scrollAmount = this.getCardWidth() * count;
    this.containerEl.scrollBy({ left: scrollAmount, behavior: "smooth" });
  }
  getCardHeight() {
    if (!this.containerEl) return 0;
    const firstCard = this.containerEl.querySelector(".card-navigator-card");
    return firstCard ? firstCard.clientHeight : 0;
  }
  getCardWidth() {
    if (!this.containerEl) return 0;
    const firstCard = this.containerEl.querySelector(".card-navigator-card");
    return firstCard ? firstCard.clientWidth : 0;
  }
  scrollToCenter() {
    this.scrollToActiveCard();
  }
  displayCards(filteredFiles) {
  }
  async searchCards(searchTerm) {
    const activeFile = this.plugin.app.workspace.getActiveFile();
    if (!activeFile) return;
    const folder = activeFile.parent;
    if (!folder) return;
    const files = folder.children.filter((file) => file instanceof import_obsidian4.TFile);
    const filteredFiles = await this.filterFilesByContent(files, searchTerm);
    const cards = await Promise.all(filteredFiles.map((file) => this.cardMaker.createCard(file)));
    this.renderCards(cards);
  }
  async displayCardsForFolder(folder) {
    const files = folder.children.filter((file) => file instanceof import_obsidian4.TFile);
    const cards = await Promise.all(files.map((file) => this.cardMaker.createCard(file)));
    this.renderCards(cards);
  }
  async filterFilesByContent(files, searchTerm) {
    const lowercaseSearchTerm = searchTerm.toLowerCase();
    const filteredFiles = [];
    for (const file of files) {
      const content = await this.plugin.app.vault.cachedRead(file);
      if (file.basename.toLowerCase().includes(lowercaseSearchTerm) || content.toLowerCase().includes(lowercaseSearchTerm)) {
        filteredFiles.push(file);
      }
    }
    return filteredFiles;
  }
  async sortCards(criterion, order) {
    this.plugin.settings.sortCriterion = criterion;
    this.plugin.settings.sortOrder = order;
    await this.plugin.saveSettings();
    this.plugin.triggerRefresh();
  }
  onClose() {
  }
};

// src/ui/cardNavigator.ts
var VIEW_TYPE_CARD_NAVIGATOR = "card-navigator-view";
var CardNavigator = class extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.plugin = plugin;
    this.toolbar = new Toolbar(this.plugin);
    this.cardContainer = new CardContainer(this.plugin, this.leaf);
    this.isVertical = this.calculateIsVertical();
    this.resizeObserver = new ResizeObserver(this.handleResize.bind(this));
  }
  getViewType() {
    return VIEW_TYPE_CARD_NAVIGATOR;
  }
  getDisplayText() {
    return "Card Navigator";
  }
  getIcon() {
    return "layers-3";
  }
  calculateIsVertical() {
    const { width, height } = this.leaf.view.containerEl.getBoundingClientRect();
    const isVertical = height > width;
    this.cardContainer.setOrientation(isVertical);
    return isVertical;
  }
  handleResize() {
    const newIsVertical = this.calculateIsVertical();
    if (newIsVertical !== this.isVertical) {
      this.isVertical = newIsVertical;
      this.cardContainer.setOrientation(this.isVertical);
    }
  }
  updateLayoutAndRefresh() {
    this.isVertical = this.calculateIsVertical();
    this.cardContainer.setOrientation(this.isVertical);
    this.toolbar.setOrientation(this.isVertical);
    this.refresh();
  }
  handleKeyDown(event) {
    if (this.containerEl && this.containerEl.contains(document.activeElement)) {
      switch (event.key) {
        case "ArrowUp":
          this.cardContainer.scrollUp();
          event.preventDefault();
          break;
        case "ArrowDown":
          this.cardContainer.scrollDown();
          event.preventDefault();
          break;
        case "ArrowLeft":
          this.cardContainer.scrollLeft();
          event.preventDefault();
          break;
        case "ArrowRight":
          this.cardContainer.scrollRight();
          event.preventDefault();
          break;
        case "PageUp":
          if (this.isVertical) {
            this.cardContainer.scrollUp();
          } else {
            this.cardContainer.scrollLeft();
          }
          event.preventDefault();
          break;
        case "PageDown":
          if (this.isVertical) {
            this.cardContainer.scrollDown();
          } else {
            this.cardContainer.scrollRight();
          }
          event.preventDefault();
          break;
        case "Home":
          this.cardContainer.scrollToCenter();
          event.preventDefault();
          break;
      }
    }
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    const toolbarEl = container.createDiv("card-navigator-toolbar");
    const cardContainerEl = container.createDiv("card-container");
    this.toolbar.initialize(toolbarEl);
    this.cardContainer.initialize(cardContainerEl);
    this.isVertical = this.calculateIsVertical();
    this.updateLayoutAndRefresh();
    this.resizeObserver.observe(this.leaf.view.containerEl);
    this.registerDomEvent(this.containerEl, "keydown", this.handleKeyDown.bind(this));
    this.refresh();
    this.centerActiveCardOnOpen();
  }
  centerActiveCardOnOpen() {
    if (this.plugin.settings.centerActiveCardOnOpen) {
      setTimeout(() => {
        this.cardContainer.centerActiveCard();
      }, 300);
    }
  }
  async onClose() {
    this.resizeObserver.disconnect();
    this.toolbar.onClose();
    this.cardContainer.onClose();
    this.containerEl.removeEventListener("keydown", this.handleKeyDown.bind(this));
  }
  refresh() {
    this.toolbar.refresh();
    this.cardContainer.refresh();
  }
};

// src/ui/settingsTab.ts
var import_obsidian6 = require("obsidian");
var SettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const createSetting = (name, desc, settingKey) => {
      return new import_obsidian6.Setting(containerEl).setName(name).setDesc(desc);
    };
    const updateSetting = async (settingKey, value) => {
      this.plugin.settings[settingKey] = value;
      await this.plugin.saveSettings();
      this.plugin.triggerRefresh();
    };
    createSetting("Cards per view", "Number of cards to display at once", "cardsPerView").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.cardsPerView).setDynamicTooltip().onChange(async (value) => {
      await updateSetting("cardsPerView", value);
    }));
    createSetting("Folder Selection", "Choose whether to use the active file's folder or a selected folder", "useSelectedFolder").addDropdown((dropdown) => dropdown.addOption("active", "Active File's Folder").addOption("selected", "Selected Folder").setValue(this.plugin.settings.useSelectedFolder ? "selected" : "active").onChange(async (value) => {
      await updateSetting("useSelectedFolder", value === "selected");
      this.display();
    }));
    if (this.plugin.settings.useSelectedFolder) {
      createSetting("Select Folder", "Choose a folder for Card Navigator", "selectedFolder").addButton((button) => button.setButtonText(this.plugin.settings.selectedFolder || "Choose folder").onClick(() => {
        new FolderSuggestModal(this.plugin, async (folder) => {
          await updateSetting("selectedFolder", folder.path);
          this.display();
        }).open();
      }));
    }
    createSetting("Default sort method", "Choose the default sorting method for cards", "sortCriterion").addDropdown((dropdown) => {
      dropdown.addOption("fileName_asc", "File name (A to Z)").addOption("fileName_desc", "File name (Z to A)").addOption("lastModified_desc", "Last modified (newest first)").addOption("lastModified_asc", "Last modified (oldest first)").addOption("created_desc", "Created (newest first)").addOption("created_asc", "Created (oldest first)").setValue(`${this.plugin.settings.sortCriterion}_${this.plugin.settings.sortOrder}`).onChange(async (value) => {
        const [criterion, order] = value.split("_");
        await updateSetting("sortCriterion", criterion);
        await updateSetting("sortOrder", order);
      });
    });
    createSetting("Fixed Card Height", "If enabled, all cards will have the same height. If disabled, card height will adjust to content.", "fixedCardHeight").addToggle((toggle) => toggle.setValue(this.plugin.settings.fixedCardHeight).onChange(async (value) => {
      await updateSetting("fixedCardHeight", value);
    }));
    createSetting("Render Content as HTML", "If enabled, card content will be rendered as HTML", "renderContentAsHtml").addToggle((toggle) => toggle.setValue(this.plugin.settings.renderContentAsHtml).onChange(async (value) => {
      await updateSetting("renderContentAsHtml", value);
    }));
    createSetting("Center Active Card on Open", "Automatically center the active card when opening the Card Navigator", "centerActiveCardOnOpen").addToggle((toggle) => toggle.setValue(this.plugin.settings.centerActiveCardOnOpen).onChange(async (value) => {
      this.plugin.settings.centerActiveCardOnOpen = value;
      await this.plugin.saveSettings();
    }));
    createSetting("Center Card Method", "Choose how to center the active card in the view", "centerCardMethod").addDropdown((dropdown) => dropdown.addOption("scroll", "Scroll to active card").addOption("centered", "Render the active card centered").setValue(this.plugin.settings.centerCardMethod).onChange(async (value) => {
      await updateSetting("centerCardMethod", value);
      this.display();
    }));
    if (this.plugin.settings.centerCardMethod === "centered") {
      createSetting("Animation Duration", "Set the duration of the card animation (in milliseconds)", "animationDuration").addSlider((slider) => slider.setLimits(0, 1e3, 50).setValue(this.plugin.settings.animationDuration).setDynamicTooltip().onChange(async (value) => {
        await updateSetting("animationDuration", value);
      }));
    }
    createSetting("Drag and Drop Content", "When enabled, dragging a card will insert the note content instead of a link.", "dragDropContent").addToggle((toggle) => toggle.setValue(this.plugin.settings.dragDropContent).onChange(async (value) => {
      await updateSetting("dragDropContent", value);
    }));
    containerEl.createEl("h3", { text: "Display items Settings" });
    const displaySettings = [
      { name: "Show File Name", key: "showFileName" },
      { name: "Show First Header", key: "showFirstHeader" },
      { name: "Show Content", key: "showContent" }
    ];
    displaySettings.forEach(({ name, key }) => {
      createSetting(name, `Toggle to display or hide the ${name.toLowerCase()} on cards`, key).addToggle((toggle) => toggle.setValue(this.plugin.settings[key]).onChange(async (value) => {
        await updateSetting(key, value);
      }));
    });
    const fontSizeSettings = [
      { name: "File Name Size", key: "fileNameSize", min: 15, max: 25 },
      { name: "First Header Size", key: "firstHeaderSize", min: 15, max: 25 },
      { name: "Content Size", key: "contentSize", min: 10, max: 20 }
    ];
    fontSizeSettings.forEach(({ name, key, min, max }) => {
      createSetting(name, `Set the font size for the ${name.toLowerCase()}`, key).addSlider((slider) => slider.setLimits(min, max, 1).setValue(this.plugin.settings[key]).setDynamicTooltip().onChange(async (value) => {
        await updateSetting(key, value);
      }));
    });
    createSetting("Content Length", "Maximum content length displayed on each card", "contentLength").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.contentLength).setDynamicTooltip().onChange(async (value) => {
      await updateSetting("contentLength", value);
    }));
  }
};

// src/common/settings.ts
var DEFAULT_SETTINGS = {
  cardsPerView: 6,
  useSelectedFolder: false,
  selectedFolder: null,
  sortCriterion: "fileName",
  sortOrder: "asc",
  fixedCardHeight: true,
  renderContentAsHtml: false,
  centerActiveCardOnOpen: true,
  centerCardMethod: "scroll",
  animationDuration: 300,
  centerActiveCardHotkey: { modifiers: ["Ctrl", "Mod"], key: "Home" },
  activeCardBorderColor: "var(--active-border-color)",
  activeCardBackgroundColor: "var(--active-background-color)",
  dragDropContent: false,
  showFileName: true,
  fileNameSize: 20,
  showFirstHeader: true,
  firstHeaderSize: 18,
  showContent: true,
  contentSize: 15,
  contentLength: 5
};

// src/main.ts
var CardNavigatorPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.settings = DEFAULT_SETTINGS;
    this.selectedFolder = null;
    this.refreshDebounced = () => {
    };
  }
  async onload() {
    await this.loadSettings();
    this.registerView(
      VIEW_TYPE_CARD_NAVIGATOR,
      (leaf) => new CardNavigator(leaf, this)
    );
    this.addSettingTab(new SettingTab(this.app, this));
    this.addRibbonIcon("layers-3", "Activate Card Navigator", () => {
      this.activateView();
    });
    this.addCommand({
      id: "scroll-up-one-card",
      name: "Scroll Up One Card",
      callback: () => this.scrollCards("up", 1),
      hotkeys: [{ modifiers: ["Ctrl", "Mod"], key: "ArrowUp" }]
    });
    this.addCommand({
      id: "scroll-down-one-card",
      name: "Scroll Down One Card",
      callback: () => this.scrollCards("down", 1),
      hotkeys: [{ modifiers: ["Ctrl", "Mod"], key: "ArrowDown" }]
    });
    this.addCommand({
      id: "scroll-left-one-card",
      name: "Scroll Left One Card",
      callback: () => this.scrollCards("left", 1),
      hotkeys: [{ modifiers: ["Ctrl", "Mod"], key: "ArrowLeft" }]
    });
    this.addCommand({
      id: "scroll-right-one-card",
      name: "Scroll Right One Card",
      callback: () => this.scrollCards("right", 1),
      hotkeys: [{ modifiers: ["Ctrl", "Mod"], key: "ArrowRight" }]
    });
    this.addCommand({
      id: "scroll-up-page",
      name: "Scroll Up One Page",
      callback: () => this.scrollCards("up", this.settings.cardsPerView),
      hotkeys: [{ modifiers: ["Ctrl", "Mod"], key: "PageUp" }]
    });
    this.addCommand({
      id: "scroll-down-page",
      name: "Scroll Down One Page",
      callback: () => this.scrollCards("down", this.settings.cardsPerView),
      hotkeys: [{ modifiers: ["Ctrl", "Mod"], key: "PageDown" }]
    });
    this.addCommand({
      id: "center-active-card",
      name: "Center Active Card",
      callback: () => {
        const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR);
        for (const leaf of leaves) {
          if (leaf.view instanceof CardNavigator) {
            leaf.view.cardContainer.centerActiveCard();
          }
        }
      },
      hotkeys: this.settings.centerActiveCardHotkey ? [this.settings.centerActiveCardHotkey] : []
    });
    this.app.workspace.onLayoutReady(() => {
      this.activateView();
    });
    this.refreshDebounced = (0, import_obsidian7.debounce)(this.refreshViews.bind(this), 100, true);
  }
  async onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR);
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    this.updateHotkey();
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.refreshDebounced();
    this.updateHotkey();
  }
  updateHotkey() {
    const command = this.app.commands.commands["card-navigator-plugin:center-active-card"];
    if (command) {
      command.hotkeys = this.settings.centerActiveCardHotkey ? [this.settings.centerActiveCardHotkey] : [];
    }
  }
  scrollCards(direction, count) {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR);
    for (const leaf of leaves) {
      if (leaf.view instanceof CardNavigator) {
        const { cardContainer } = leaf.view;
        const isVertical = cardContainer.isVertical;
        switch (direction) {
          case "up":
            isVertical ? cardContainer.scrollUp(count) : cardContainer.scrollLeft(count);
            break;
          case "down":
            isVertical ? cardContainer.scrollDown(count) : cardContainer.scrollRight(count);
            break;
          case "left":
            cardContainer.scrollLeft(count);
            break;
          case "right":
            cardContainer.scrollRight(count);
            break;
        }
      }
    }
  }
  refreshViews() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR);
    leaves.forEach((leaf) => {
      if (leaf.view instanceof CardNavigator) {
        leaf.view.updateLayoutAndRefresh();
      }
    });
  }
  displayFilteredCards(filteredFiles) {
    var _a;
    const view = (_a = this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR)[0]) == null ? void 0 : _a.view;
    if (view) {
      view.cardContainer.displayCards(filteredFiles);
    }
  }
  sortCards(criterion, order) {
    var _a;
    const view = (_a = this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR)[0]) == null ? void 0 : _a.view;
    if (view) {
      view.cardContainer.sortCards(criterion, order);
    }
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR)[0];
    if (!leaf) {
      const rightLeaf = workspace.getRightLeaf(false);
      if (rightLeaf) {
        await rightLeaf.setViewState({ type: VIEW_TYPE_CARD_NAVIGATOR, active: true });
        leaf = workspace.getLeavesOfType(VIEW_TYPE_CARD_NAVIGATOR)[0];
      }
    }
    if (leaf) {
      workspace.revealLeaf(leaf);
    }
  }
  triggerRefresh() {
    this.refreshDebounced();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3VpL2NhcmROYXZpZ2F0b3IudHMiLCAic3JjL3VpL3Rvb2xiYXIvdG9vbGJhci50cyIsICJzcmMvdWkvdG9vbGJhci90b29sYmFyQWN0aW9ucy50cyIsICJzcmMvdWkvY2FyZENvbnRhaW5lci9jYXJkQ29udGFpbmVyLnRzIiwgInNyYy91aS9jYXJkQ29udGFpbmVyL2NhcmRNYWtlci50cyIsICJzcmMvY29tbW9uL3V0aWxzLnRzIiwgInNyYy91aS9zZXR0aW5nc1RhYi50cyIsICJzcmMvY29tbW9uL3NldHRpbmdzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvLyBzcmMvbWFpbi50c1xuXG5pbXBvcnQgeyBQbHVnaW4sIFRGaWxlLCBkZWJvdW5jZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENhcmROYXZpZ2F0b3IsIFZJRVdfVFlQRV9DQVJEX05BVklHQVRPUiB9IGZyb20gJy4vdWkvY2FyZE5hdmlnYXRvcic7XG5pbXBvcnQgeyBTZXR0aW5nVGFiIH0gZnJvbSAnLi91aS9zZXR0aW5nc1RhYic7XG5pbXBvcnQgeyBDYXJkTmF2aWdhdG9yU2V0dGluZ3MsIFNvcnRDcml0ZXJpb24gfSBmcm9tICcuL2NvbW1vbi90eXBlcyc7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9jb21tb24vc2V0dGluZ3MnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkTmF2aWdhdG9yUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogQ2FyZE5hdmlnYXRvclNldHRpbmdzID0gREVGQVVMVF9TRVRUSU5HUztcbiAgICBzZWxlY3RlZEZvbGRlcjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgcHVibGljIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCB8IHVuZGVmaW5lZDtcbiAgICBwcml2YXRlIHJlZnJlc2hEZWJvdW5jZWQ6ICgpID0+IHZvaWQgPSAoKSA9PiB7fTtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlldyhcbiAgICAgICAgICAgIFZJRVdfVFlQRV9DQVJEX05BVklHQVRPUixcbiAgICAgICAgICAgIChsZWFmKSA9PiBuZXcgQ2FyZE5hdmlnYXRvcihsZWFmLCB0aGlzKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIHRoaXMuYWRkUmliYm9uSWNvbignbGF5ZXJzLTMnLCAnQWN0aXZhdGUgQ2FyZCBOYXZpZ2F0b3InLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2YXRlVmlldygpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzY3JvbGwtdXAtb25lLWNhcmQnLFxuICAgICAgICAgICAgbmFtZTogJ1Njcm9sbCBVcCBPbmUgQ2FyZCcsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zY3JvbGxDYXJkcygndXAnLCAxKSxcbiAgICAgICAgICAgIGhvdGtleXM6IFt7IG1vZGlmaWVyczogWydDdHJsJywgJ01vZCddLCBrZXk6ICdBcnJvd1VwJyB9XVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzY3JvbGwtZG93bi1vbmUtY2FyZCcsXG4gICAgICAgICAgICBuYW1lOiAnU2Nyb2xsIERvd24gT25lIENhcmQnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuc2Nyb2xsQ2FyZHMoJ2Rvd24nLCAxKSxcbiAgICAgICAgICAgIGhvdGtleXM6IFt7IG1vZGlmaWVyczogWydDdHJsJywgJ01vZCddLCBrZXk6ICdBcnJvd0Rvd24nIH1dXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3Njcm9sbC1sZWZ0LW9uZS1jYXJkJyxcbiAgICAgICAgICAgIG5hbWU6ICdTY3JvbGwgTGVmdCBPbmUgQ2FyZCcsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zY3JvbGxDYXJkcygnbGVmdCcsIDEpLFxuICAgICAgICAgICAgaG90a2V5czogW3sgbW9kaWZpZXJzOiBbJ0N0cmwnLCAnTW9kJ10sIGtleTogJ0Fycm93TGVmdCcgfV1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc2Nyb2xsLXJpZ2h0LW9uZS1jYXJkJyxcbiAgICAgICAgICAgIG5hbWU6ICdTY3JvbGwgUmlnaHQgT25lIENhcmQnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuc2Nyb2xsQ2FyZHMoJ3JpZ2h0JywgMSksXG4gICAgICAgICAgICBob3RrZXlzOiBbeyBtb2RpZmllcnM6IFsnQ3RybCcsICdNb2QnXSwga2V5OiAnQXJyb3dSaWdodCcgfV1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc2Nyb2xsLXVwLXBhZ2UnLFxuICAgICAgICAgICAgbmFtZTogJ1Njcm9sbCBVcCBPbmUgUGFnZScsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zY3JvbGxDYXJkcygndXAnLCB0aGlzLnNldHRpbmdzLmNhcmRzUGVyVmlldyksXG4gICAgICAgICAgICBob3RrZXlzOiBbeyBtb2RpZmllcnM6IFsnQ3RybCcsICdNb2QnXSwga2V5OiAnUGFnZVVwJyB9XVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzY3JvbGwtZG93bi1wYWdlJyxcbiAgICAgICAgICAgIG5hbWU6ICdTY3JvbGwgRG93biBPbmUgUGFnZScsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5zY3JvbGxDYXJkcygnZG93bicsIHRoaXMuc2V0dGluZ3MuY2FyZHNQZXJWaWV3KSxcbiAgICAgICAgICAgIGhvdGtleXM6IFt7IG1vZGlmaWVyczogWydDdHJsJywgJ01vZCddLCBrZXk6ICdQYWdlRG93bicgfV1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnY2VudGVyLWFjdGl2ZS1jYXJkJyxcbiAgICAgICAgICAgIG5hbWU6ICdDZW50ZXIgQWN0aXZlIENhcmQnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9DQVJEX05BVklHQVRPUik7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGVhZi52aWV3IGluc3RhbmNlb2YgQ2FyZE5hdmlnYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVhZi52aWV3LmNhcmRDb250YWluZXIuY2VudGVyQWN0aXZlQ2FyZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhvdGtleXM6IHRoaXMuc2V0dGluZ3MuY2VudGVyQWN0aXZlQ2FyZEhvdGtleSA/IFt0aGlzLnNldHRpbmdzLmNlbnRlckFjdGl2ZUNhcmRIb3RrZXldIDogW11cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBkZWJvdW5jZWQgcmVmcmVzaCBmdW5jdGlvblxuICAgICAgICB0aGlzLnJlZnJlc2hEZWJvdW5jZWQgPSBkZWJvdW5jZSh0aGlzLnJlZnJlc2hWaWV3cy5iaW5kKHRoaXMpLCAxMDAsIHRydWUpO1xuICAgIH1cblxuICAgIGFzeW5jIG9udW5sb2FkKCkge1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZGV0YWNoTGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9DQVJEX05BVklHQVRPUik7XG4gICAgfVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0XHR0aGlzLnVwZGF0ZUhvdGtleSgpO1xuXHR9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMucmVmcmVzaERlYm91bmNlZCgpO1xuXHRcdHRoaXMudXBkYXRlSG90a2V5KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVIb3RrZXkoKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgY29tbWFuZCA9IHRoaXMuYXBwLmNvbW1hbmRzLmNvbW1hbmRzWydjYXJkLW5hdmlnYXRvci1wbHVnaW46Y2VudGVyLWFjdGl2ZS1jYXJkJ107XG4gICAgICAgIGlmIChjb21tYW5kKSB7XG4gICAgICAgICAgICBjb21tYW5kLmhvdGtleXMgPSB0aGlzLnNldHRpbmdzLmNlbnRlckFjdGl2ZUNhcmRIb3RrZXkgPyBbdGhpcy5zZXR0aW5ncy5jZW50ZXJBY3RpdmVDYXJkSG90a2V5XSA6IFtdO1xuICAgICAgICB9XG4gICAgfVxuXG5cdHByaXZhdGUgc2Nyb2xsQ2FyZHMoZGlyZWN0aW9uOiAndXAnIHwgJ2Rvd24nIHwgJ2xlZnQnIHwgJ3JpZ2h0JywgY291bnQ6IG51bWJlcikge1xuXHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0NBUkRfTkFWSUdBVE9SKTtcblx0XHRmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG5cdFx0XHRpZiAobGVhZi52aWV3IGluc3RhbmNlb2YgQ2FyZE5hdmlnYXRvcikge1xuXHRcdFx0XHRjb25zdCB7IGNhcmRDb250YWluZXIgfSA9IGxlYWYudmlldztcblx0XHRcdFx0Y29uc3QgaXNWZXJ0aWNhbCA9IGNhcmRDb250YWluZXIuaXNWZXJ0aWNhbDtcblx0XG5cdFx0XHRcdHN3aXRjaCAoZGlyZWN0aW9uKSB7XG5cdFx0XHRcdFx0Y2FzZSAndXAnOlxuXHRcdFx0XHRcdFx0aXNWZXJ0aWNhbCA/IGNhcmRDb250YWluZXIuc2Nyb2xsVXAoY291bnQpIDogY2FyZENvbnRhaW5lci5zY3JvbGxMZWZ0KGNvdW50KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ2Rvd24nOlxuXHRcdFx0XHRcdFx0aXNWZXJ0aWNhbCA/IGNhcmRDb250YWluZXIuc2Nyb2xsRG93bihjb3VudCkgOiBjYXJkQ29udGFpbmVyLnNjcm9sbFJpZ2h0KGNvdW50KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ2xlZnQnOlxuXHRcdFx0XHRcdFx0Y2FyZENvbnRhaW5lci5zY3JvbGxMZWZ0KGNvdW50KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ3JpZ2h0Jzpcblx0XHRcdFx0XHRcdGNhcmRDb250YWluZXIuc2Nyb2xsUmlnaHQoY291bnQpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuICAgIHJlZnJlc2hWaWV3cygpIHtcbiAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfQ0FSRF9OQVZJR0FUT1IpO1xuICAgICAgICBsZWF2ZXMuZm9yRWFjaCgobGVhZikgPT4ge1xuICAgICAgICAgICAgaWYgKGxlYWYudmlldyBpbnN0YW5jZW9mIENhcmROYXZpZ2F0b3IpIHtcbiAgICAgICAgICAgICAgICBsZWFmLnZpZXcudXBkYXRlTGF5b3V0QW5kUmVmcmVzaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBkaXNwbGF5RmlsdGVyZWRDYXJkcyhmaWx0ZXJlZEZpbGVzOiBURmlsZVtdKSB7XG4gICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9DQVJEX05BVklHQVRPUilbMF0/LnZpZXcgYXMgQ2FyZE5hdmlnYXRvcjtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuY2FyZENvbnRhaW5lci5kaXNwbGF5Q2FyZHMoZmlsdGVyZWRGaWxlcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzb3J0Q2FyZHMoY3JpdGVyaW9uOiBTb3J0Q3JpdGVyaW9uLCBvcmRlcjogJ2FzYycgfCAnZGVzYycpIHtcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0NBUkRfTkFWSUdBVE9SKVswXT8udmlldyBhcyBDYXJkTmF2aWdhdG9yO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5jYXJkQ29udGFpbmVyLnNvcnRDYXJkcyhjcml0ZXJpb24sIG9yZGVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGFjdGl2YXRlVmlldygpIHtcbiAgICAgICAgY29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xuICAgICAgICBsZXQgbGVhZiA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0NBUkRfTkFWSUdBVE9SKVswXTtcblxuICAgICAgICBpZiAoIWxlYWYpIHtcbiAgICAgICAgICAgIGNvbnN0IHJpZ2h0TGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuICAgICAgICAgICAgaWYgKHJpZ2h0TGVhZikge1xuICAgICAgICAgICAgICAgIGF3YWl0IHJpZ2h0TGVhZi5zZXRWaWV3U3RhdGUoeyB0eXBlOiBWSUVXX1RZUEVfQ0FSRF9OQVZJR0FUT1IsIGFjdGl2ZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICBsZWFmID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfQ0FSRF9OQVZJR0FUT1IpWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxlYWYpIHtcbiAgICAgICAgICAgIHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuICAgICAgICB9XG4gICAgfVxuXHRcbiAgICB0cmlnZ2VyUmVmcmVzaCgpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoRGVib3VuY2VkKCk7XG4gICAgfVxufVxuIiwgIi8vIHNyYy91aS9jYXJkTmF2aWdhdG9yLnRzXG5cbmltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgQ2FyZE5hdmlnYXRvclBsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IFRvb2xiYXIgfSBmcm9tICcuL3Rvb2xiYXIvdG9vbGJhcic7XG5pbXBvcnQgeyBDYXJkQ29udGFpbmVyIH0gZnJvbSAnLi9jYXJkQ29udGFpbmVyL2NhcmRDb250YWluZXInO1xuXG5leHBvcnQgY29uc3QgVklFV19UWVBFX0NBUkRfTkFWSUdBVE9SID0gXCJjYXJkLW5hdmlnYXRvci12aWV3XCI7XG5cbmV4cG9ydCBjbGFzcyBDYXJkTmF2aWdhdG9yIGV4dGVuZHMgSXRlbVZpZXcge1xuICAgIHByaXZhdGUgcGx1Z2luOiBDYXJkTmF2aWdhdG9yUGx1Z2luO1xuICAgIHB1YmxpYyB0b29sYmFyOiBUb29sYmFyO1xuICAgIHB1YmxpYyBjYXJkQ29udGFpbmVyOiBDYXJkQ29udGFpbmVyO1xuICAgIHByaXZhdGUgcmVzaXplT2JzZXJ2ZXI6IFJlc2l6ZU9ic2VydmVyO1xuICAgIHByaXZhdGUgaXNWZXJ0aWNhbDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogQ2FyZE5hdmlnYXRvclBsdWdpbikge1xuICAgICAgICBzdXBlcihsZWFmKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMudG9vbGJhciA9IG5ldyBUb29sYmFyKHRoaXMucGx1Z2luKTtcbiAgICAgICAgdGhpcy5jYXJkQ29udGFpbmVyID0gbmV3IENhcmRDb250YWluZXIodGhpcy5wbHVnaW4sIHRoaXMubGVhZik7XG4gICAgICAgIHRoaXMuaXNWZXJ0aWNhbCA9IHRoaXMuY2FsY3VsYXRlSXNWZXJ0aWNhbCgpO1xuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKHRoaXMuaGFuZGxlUmVzaXplLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIGdldFZpZXdUeXBlKCkge1xuICAgICAgICByZXR1cm4gVklFV19UWVBFX0NBUkRfTkFWSUdBVE9SO1xuICAgIH1cblxuICAgIGdldERpc3BsYXlUZXh0KCkge1xuICAgICAgICByZXR1cm4gXCJDYXJkIE5hdmlnYXRvclwiO1xuICAgIH1cblxuICAgIGdldEljb24oKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIFwibGF5ZXJzLTNcIjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNhbGN1bGF0ZUlzVmVydGljYWwoKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gdGhpcy5sZWFmLnZpZXcuY29udGFpbmVyRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnN0IGlzVmVydGljYWwgPSBoZWlnaHQgPiB3aWR0aDtcbiAgICAgICAgdGhpcy5jYXJkQ29udGFpbmVyLnNldE9yaWVudGF0aW9uKGlzVmVydGljYWwpO1xuICAgICAgICByZXR1cm4gaXNWZXJ0aWNhbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZVJlc2l6ZSgpIHtcbiAgICAgICAgY29uc3QgbmV3SXNWZXJ0aWNhbCA9IHRoaXMuY2FsY3VsYXRlSXNWZXJ0aWNhbCgpO1xuICAgICAgICBpZiAobmV3SXNWZXJ0aWNhbCAhPT0gdGhpcy5pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICB0aGlzLmlzVmVydGljYWwgPSBuZXdJc1ZlcnRpY2FsO1xuICAgICAgICAgICAgdGhpcy5jYXJkQ29udGFpbmVyLnNldE9yaWVudGF0aW9uKHRoaXMuaXNWZXJ0aWNhbCk7XG4gICAgICAgIH1cbiAgICB9XG5cblx0cHVibGljIHVwZGF0ZUxheW91dEFuZFJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuaXNWZXJ0aWNhbCA9IHRoaXMuY2FsY3VsYXRlSXNWZXJ0aWNhbCgpO1xuICAgICAgICB0aGlzLmNhcmRDb250YWluZXIuc2V0T3JpZW50YXRpb24odGhpcy5pc1ZlcnRpY2FsKTtcbiAgICAgICAgdGhpcy50b29sYmFyLnNldE9yaWVudGF0aW9uKHRoaXMuaXNWZXJ0aWNhbCk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlS2V5RG93bihldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5jb250YWluZXJFbCAmJiB0aGlzLmNvbnRhaW5lckVsLmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGV2ZW50LmtleSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhcmRDb250YWluZXIuc2Nyb2xsVXAoKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXJkQ29udGFpbmVyLnNjcm9sbERvd24oKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQXJyb3dMZWZ0JzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXJkQ29udGFpbmVyLnNjcm9sbExlZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQXJyb3dSaWdodCc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FyZENvbnRhaW5lci5zY3JvbGxSaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdQYWdlVXAnOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhcmRDb250YWluZXIuc2Nyb2xsVXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FyZENvbnRhaW5lci5zY3JvbGxMZWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnUGFnZURvd24nOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhcmRDb250YWluZXIuc2Nyb2xsRG93bigpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXJkQ29udGFpbmVyLnNjcm9sbFJpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnSG9tZSc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FyZENvbnRhaW5lci5zY3JvbGxUb0NlbnRlcigpO1xuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICAgICAgY29uc3QgdG9vbGJhckVsID0gY29udGFpbmVyLmNyZWF0ZURpdignY2FyZC1uYXZpZ2F0b3ItdG9vbGJhcicpO1xuICAgICAgICBjb25zdCBjYXJkQ29udGFpbmVyRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KCdjYXJkLWNvbnRhaW5lcicpO1xuXG4gICAgICAgIHRoaXMudG9vbGJhci5pbml0aWFsaXplKHRvb2xiYXJFbCk7XG4gICAgICAgIHRoaXMuY2FyZENvbnRhaW5lci5pbml0aWFsaXplKGNhcmRDb250YWluZXJFbCk7XG5cbiAgICAgICAgdGhpcy5pc1ZlcnRpY2FsID0gdGhpcy5jYWxjdWxhdGVJc1ZlcnRpY2FsKCk7XG4gICAgICAgIHRoaXMudXBkYXRlTGF5b3V0QW5kUmVmcmVzaCgpO1xuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyLm9ic2VydmUodGhpcy5sZWFmLnZpZXcuY29udGFpbmVyRWwpO1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudCh0aGlzLmNvbnRhaW5lckVsLCAna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcblxuXHRcdHRoaXMuY2VudGVyQWN0aXZlQ2FyZE9uT3BlbigpO1xuICAgIH1cblxuXHRwcml2YXRlIGNlbnRlckFjdGl2ZUNhcmRPbk9wZW4oKSB7XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNlbnRlckFjdGl2ZUNhcmRPbk9wZW4pIHtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmNhcmRDb250YWluZXIuY2VudGVyQWN0aXZlQ2FyZCgpO1xuXHRcdFx0fSwgMzAwKTtcblx0XHR9XG5cdH1cblxuICAgIGFzeW5jIG9uQ2xvc2UoKSB7XG4gICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLnRvb2xiYXIub25DbG9zZSgpO1xuICAgICAgICB0aGlzLmNhcmRDb250YWluZXIub25DbG9zZSgpO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICByZWZyZXNoKCkge1xuICAgICAgICB0aGlzLnRvb2xiYXIucmVmcmVzaCgpO1xuICAgICAgICB0aGlzLmNhcmRDb250YWluZXIucmVmcmVzaCgpO1xuICAgIH1cbn1cbiIsICIvLyBzcmMvdWkvdG9vbGJhci90b29sYmFyLnRzXG5cbmltcG9ydCB7IHNldEljb24sIFRGb2xkZXIsIGRlYm91bmNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IENhcmROYXZpZ2F0b3JQbHVnaW4gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBDYXJkTmF2aWdhdG9yIH0gZnJvbSAnLi4vY2FyZE5hdmlnYXRvcic7XG5pbXBvcnQgeyBGb2xkZXJTdWdnZXN0TW9kYWwgfSBmcm9tICcuL3Rvb2xiYXJBY3Rpb25zJztcbmltcG9ydCB7IHRvZ2dsZVNvcnQsIHRvZ2dsZVNldHRpbmdzIH0gZnJvbSAnLi90b29sYmFyQWN0aW9ucyc7XG5cbmV4cG9ydCBjbGFzcyBUb29sYmFyIHtcbiAgICBwcml2YXRlIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICBwcml2YXRlIGlzVmVydGljYWw6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogQ2FyZE5hdmlnYXRvclBsdWdpbikge1xuICAgICAgICB0aGlzLmlzVmVydGljYWwgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsID0gY29udGFpbmVyRWw7XG4gICAgICAgIHRoaXMuY3JlYXRlVG9vbGJhcigpO1xuICAgIH1cblxuXHRzZXRPcmllbnRhdGlvbihpc1ZlcnRpY2FsOiBib29sZWFuKSB7XG4gICAgICAgIGlmICh0aGlzLmlzVmVydGljYWwgIT09IGlzVmVydGljYWwpIHtcbiAgICAgICAgICAgIHRoaXMuaXNWZXJ0aWNhbCA9IGlzVmVydGljYWw7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRvb2xiYXJTdHlsZSgpO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVUb29sYmFyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cblx0cHJpdmF0ZSB1cGRhdGVUb29sYmFyU3R5bGUoKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRhaW5lckVsKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNsYXNzTGlzdC50b2dnbGUoJ3ZlcnRpY2FsJywgdGhpcy5pc1ZlcnRpY2FsKTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuY2xhc3NMaXN0LnRvZ2dsZSgnaG9yaXpvbnRhbCcsICF0aGlzLmlzVmVydGljYWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVUb29sYmFyKCkge1xuICAgICAgICBpZiAoIXRoaXMuY29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICBjb25zdCB0b29sYmFyQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRvb2xiYXJDb250YWluZXIuY2xhc3NOYW1lID0gJ2NhcmQtbmF2aWdhdG9yLXRvb2xiYXItY29udGFpbmVyJztcblxuICAgICAgICBjb25zdCBzZWFyY2hDb250YWluZXIgPSB0aGlzLmNyZWF0ZVNlYXJjaENvbnRhaW5lcigpO1xuICAgICAgICBjb25zdCBzZXBhcmF0b3IgPSB0aGlzLmNyZWF0ZVNlcGFyYXRvcigpO1xuICAgICAgICBjb25zdCBhY3Rpb25JY29uc0NvbnRhaW5lciA9IHRoaXMuY3JlYXRlQWN0aW9uSWNvbnNDb250YWluZXIoKTtcblxuICAgICAgICB0b29sYmFyQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlYXJjaENvbnRhaW5lcik7XG4gICAgICAgIHRvb2xiYXJDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VwYXJhdG9yKTtcbiAgICAgICAgdG9vbGJhckNvbnRhaW5lci5hcHBlbmRDaGlsZChhY3Rpb25JY29uc0NvbnRhaW5lcik7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hcHBlbmRDaGlsZCh0b29sYmFyQ29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVNlYXJjaENvbnRhaW5lcigpOiBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJ2NhcmQtbmF2aWdhdG9yLXNlYXJjaC1jb250YWluZXInO1xuXG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgaW5wdXQudHlwZSA9ICd0ZXh0JztcbiAgICAgICAgaW5wdXQucGxhY2Vob2xkZXIgPSAnU2VhcmNoLi4uJztcbiAgICAgICAgaW5wdXQuY2xhc3NOYW1lID0gJ2NhcmQtbmF2aWdhdG9yLXNlYXJjaC1pbnB1dCc7XG5cbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBkZWJvdW5jZShhc3luYyAoZTogRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNlYXJjaFRlcm0gPSAoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWU7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2NhcmQtbmF2aWdhdG9yLXZpZXcnKVswXS52aWV3IGFzIENhcmROYXZpZ2F0b3I7XG4gICAgICAgICAgICBhd2FpdCB2aWV3LmNhcmRDb250YWluZXIuc2VhcmNoQ2FyZHMoc2VhcmNoVGVybSk7XG4gICAgICAgIH0sIDMwMCkpO1xuXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVBY3Rpb25JY29uc0NvbnRhaW5lcigpOiBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJ2NhcmQtbmF2aWdhdG9yLWFjdGlvbi1pY29ucy1jb250YWluZXInO1xuXG4gICAgICAgIGNvbnN0IGljb25zID0gW1xuICAgICAgICAgICAgeyBuYW1lOiAnZm9sZGVyJywgbGFiZWw6ICdTZWxlY3QgZm9sZGVyJywgYWN0aW9uOiAoKSA9PiB0aGlzLm9wZW5Gb2xkZXJTZWxlY3RvcigpIH0sXG4gICAgICAgICAgICB7IG5hbWU6ICdhcnJvdy11cC1uYXJyb3ctd2lkZScsIGxhYmVsOiAnU29ydCBjYXJkcycsIGFjdGlvbjogKCkgPT4gdG9nZ2xlU29ydCh0aGlzLnBsdWdpbikgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ3NldHRpbmdzJywgbGFiZWw6ICdTZXR0aW5ncycsIGFjdGlvbjogKCkgPT4gdG9nZ2xlU2V0dGluZ3ModGhpcy5wbHVnaW4pIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgaWNvbnMuZm9yRWFjaChpY29uID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGljb25FbGVtZW50ID0gdGhpcy5jcmVhdGVUb29sYmFySWNvbihpY29uLm5hbWUsIGljb24ubGFiZWwsIGljb24uYWN0aW9uKTtcbiAgICAgICAgICAgIGlmIChpY29uLm5hbWUgPT09ICdhcnJvdy11cC1uYXJyb3ctd2lkZScpIHtcbiAgICAgICAgICAgICAgICBpY29uRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydENyaXRlcmlvbiAhPT0gJ2ZpbGVOYW1lJyB8fCBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydE9yZGVyICE9PSAnYXNjJ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaWNvbkVsZW1lbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY29udGFpbmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlVG9vbGJhckljb24oaWNvbk5hbWU6IHN0cmluZywgYXJpYUxhYmVsOiBzdHJpbmcsIGFjdGlvbjogKGU6IE1vdXNlRXZlbnQpID0+IHZvaWQpOiBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnY2xpY2thYmxlLWljb24nO1xuICAgICAgICBpY29uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGFyaWFMYWJlbCk7XG5cbiAgICAgICAgc2V0SWNvbihpY29uLCBpY29uTmFtZSk7XG4gICAgICAgIGljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhY3Rpb24pO1xuXG4gICAgICAgIHJldHVybiBpY29uO1xuICAgIH1cblx0XG5cdHByaXZhdGUgY3JlYXRlU2VwYXJhdG9yKCk6IEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3Qgc2VwYXJhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHNlcGFyYXRvci5jbGFzc05hbWUgPSAndG9vbGJhci1zZXBhcmF0b3InO1xuICAgICAgICByZXR1cm4gc2VwYXJhdG9yO1xuICAgIH1cblxuXHRwdWJsaWMgb3BlbkZvbGRlclNlbGVjdG9yKCkge1xuXHRcdG5ldyBGb2xkZXJTdWdnZXN0TW9kYWwodGhpcy5wbHVnaW4sIChmb2xkZXI6IFRGb2xkZXIpID0+IHtcblx0XHRcdGNvbnN0IHZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoQ2FyZE5hdmlnYXRvcik7XG5cdFx0XHRpZiAodmlldykge1xuXHRcdFx0XHR2aWV3LmNhcmRDb250YWluZXIuZGlzcGxheUNhcmRzRm9yRm9sZGVyKGZvbGRlcik7XG5cdFx0XHR9XG5cdFx0fSkub3BlbigpO1xuXHR9XG5cbiAgICByZWZyZXNoKCkge1xuICAgICAgICAvLyBJbXBsZW1lbnQgcmVmcmVzaCBsb2dpYyBpZiBuZWNlc3NhcnlcbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICAvLyBDbGVhbnVwIHRvb2xiYXItcmVsYXRlZCByZXNvdXJjZXNcbiAgICB9XG59XG4iLCAiLy8gc3JjL3VpL3Rvb2xiYXIvdG9vbGJhckFjdGlvbnMudHNcblxuaW1wb3J0IHsgVEZvbGRlciwgRnV6enlTdWdnZXN0TW9kYWwgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQ2FyZE5hdmlnYXRvclBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IFNvcnRDcml0ZXJpb24sIENhcmROYXZpZ2F0b3JTZXR0aW5ncyB9IGZyb20gJy4uLy4uL2NvbW1vbi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBGb2xkZXJTdWdnZXN0TW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURm9sZGVyPiB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IENhcmROYXZpZ2F0b3JQbHVnaW4sIHByaXZhdGUgb25TZWxlY3Q6IChmb2xkZXI6IFRGb2xkZXIpID0+IHZvaWQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVEZvbGRlcltdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpXG4gICAgICAgICAgICAuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURm9sZGVyID0+IGZpbGUgaW5zdGFuY2VvZiBURm9sZGVyKTtcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChmb2xkZXI6IFRGb2xkZXIpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gZm9sZGVyLnBhdGg7XG4gICAgfVxuXG4gICAgb25DaG9vc2VJdGVtKGZvbGRlcjogVEZvbGRlcik6IHZvaWQge1xuICAgICAgICB0aGlzLm9uU2VsZWN0KGZvbGRlcik7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlU29ydChwbHVnaW46IENhcmROYXZpZ2F0b3JQbHVnaW4pIHtcbiAgICBsZXQgc29ydFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtbmF2aWdhdG9yLXNvcnQtcG9wdXAnKSBhcyBIVE1MRWxlbWVudDtcblxuICAgIGlmICghc29ydFBvcHVwKSB7XG4gICAgICAgIHNvcnRQb3B1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBzb3J0UG9wdXAuY2xhc3NOYW1lID0gJ2NhcmQtbmF2aWdhdG9yLXNvcnQtcG9wdXAnO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRTb3J0ID0gYCR7cGx1Z2luLnNldHRpbmdzLnNvcnRDcml0ZXJpb259XyR7cGx1Z2luLnNldHRpbmdzLnNvcnRPcmRlcn1gO1xuXG4gICAgICAgIGNvbnN0IGFkZFNvcnRPcHRpb24gPSAodmFsdWU6IHN0cmluZywgbGFiZWw6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgICBvcHRpb24udGV4dENvbnRlbnQgPSBsYWJlbDtcbiAgICAgICAgICAgIG9wdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCBjdXJyZW50U29ydCA9PT0gdmFsdWUpO1xuICAgICAgICAgICAgb3B0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtjcml0ZXJpb24sIG9yZGVyXSA9IHZhbHVlLnNwbGl0KCdfJykgYXMgW1NvcnRDcml0ZXJpb24sICdhc2MnIHwgJ2Rlc2MnXTtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3Muc29ydENyaXRlcmlvbiA9IGNyaXRlcmlvbjtcbiAgICAgICAgICAgICAgICBwbHVnaW4uc2V0dGluZ3Muc29ydE9yZGVyID0gb3JkZXI7XG4gICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIHBsdWdpbi50cmlnZ2VyUmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgIHNvcnRQb3B1cC5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc29ydFBvcHVwLmFwcGVuZENoaWxkKG9wdGlvbik7XG4gICAgICAgIH07XG5cbiAgICAgICAgYWRkU29ydE9wdGlvbignZmlsZU5hbWVfYXNjJywgJ0ZpbGUgbmFtZSAoQSB0byBaKScpO1xuICAgICAgICBhZGRTb3J0T3B0aW9uKCdmaWxlTmFtZV9kZXNjJywgJ0ZpbGUgbmFtZSAoWiB0byBBKScpO1xuICAgICAgICBhZGRTb3J0T3B0aW9uKCdsYXN0TW9kaWZpZWRfZGVzYycsICdMYXN0IG1vZGlmaWVkIChuZXdlc3QgZmlyc3QpJyk7XG4gICAgICAgIGFkZFNvcnRPcHRpb24oJ2xhc3RNb2RpZmllZF9hc2MnLCAnTGFzdCBtb2RpZmllZCAob2xkZXN0IGZpcnN0KScpO1xuICAgICAgICBhZGRTb3J0T3B0aW9uKCdjcmVhdGVkX2Rlc2MnLCAnQ3JlYXRlZCAobmV3ZXN0IGZpcnN0KScpO1xuICAgICAgICBhZGRTb3J0T3B0aW9uKCdjcmVhdGVkX2FzYycsICdDcmVhdGVkIChvbGRlc3QgZmlyc3QpJyk7XG5cbiAgICAgICAgLy8gXHVEMjM0XHVCQzE0IFx1RDU1OFx1QjJFOFx1QzVEMCBcdUJDMzBcdUNFNThcbiAgICAgICAgY29uc3QgdG9vbGJhckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtbmF2aWdhdG9yLXRvb2xiYXItY29udGFpbmVyJyk7XG4gICAgICAgIGlmICh0b29sYmFyRWwpIHtcbiAgICAgICAgICAgIHRvb2xiYXJFbC5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgc29ydFBvcHVwKTtcblxuICAgICAgICAgICAgLy8gXHVENjU0XHVCQTc0XHVDNzU4IFx1QjJFNFx1Qjk3OCBcdUFDRjNcdUM3NDQgXHVEMDc0XHVCOUFEXHVENTU4XHVCQTc0IFx1RDMxRFx1QzVDNVx1Qzc0NCBcdUIyRUJcdUIyOTQgXHVDNzc0XHVCQ0E0XHVEMkI4IFx1Q0Q5NFx1QUMwMFxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiBvbkNsaWNrT3V0c2lkZShldmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChzb3J0UG9wdXAgJiYgIXNvcnRQb3B1cC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkgJiYgIXRvb2xiYXJFbC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc29ydFBvcHVwLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2tPdXRzaWRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHNvcnRQb3B1cC5yZW1vdmUoKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVTZXR0aW5ncyhwbHVnaW46IENhcmROYXZpZ2F0b3JQbHVnaW4pIHtcbiAgICBsZXQgc2V0dGluZ3NQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkLW5hdmlnYXRvci1zZXR0aW5ncy1wb3B1cCcpIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgaWYgKCFzZXR0aW5nc1BvcHVwKSB7XG4gICAgICAgIHNldHRpbmdzUG9wdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgc2V0dGluZ3NQb3B1cC5jbGFzc05hbWUgPSAnY2FyZC1uYXZpZ2F0b3Itc2V0dGluZ3MtcG9wdXAnO1xuXG4gICAgICAgIGNvbnN0IHVwZGF0ZVNldHRpbmcgPSBhc3luYyA8SyBleHRlbmRzIGtleW9mIENhcmROYXZpZ2F0b3JTZXR0aW5ncz4oXG4gICAgICAgICAgICBzZXR0aW5nS2V5OiBLLFxuICAgICAgICAgICAgdmFsdWU6IENhcmROYXZpZ2F0b3JTZXR0aW5nc1tLXVxuICAgICAgICApID0+IHtcbiAgICAgICAgICAgIHBsdWdpbi5zZXR0aW5nc1tzZXR0aW5nS2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgcGx1Z2luLnRyaWdnZXJSZWZyZXNoKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gXHVDRTc0XHVCNERDIFx1QzIxOCBcdUMxMjRcdUM4MTVcbiAgICAgICAgY29uc3QgY2FyZHNQZXJWaWV3U2V0dGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIGNhcmRzUGVyVmlld1NldHRpbmcudHlwZSA9ICdyYW5nZSc7XG4gICAgICAgIGNhcmRzUGVyVmlld1NldHRpbmcubWluID0gJzEnO1xuICAgICAgICBjYXJkc1BlclZpZXdTZXR0aW5nLm1heCA9ICcxMCc7XG4gICAgICAgIGNhcmRzUGVyVmlld1NldHRpbmcudmFsdWUgPSBwbHVnaW4uc2V0dGluZ3MuY2FyZHNQZXJWaWV3LnRvU3RyaW5nKCk7XG4gICAgICAgIGNhcmRzUGVyVmlld1NldHRpbmcuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZUludCgoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUsIDEwKTtcbiAgICAgICAgICAgIHVwZGF0ZVNldHRpbmcoJ2NhcmRzUGVyVmlldycsIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNhcmRzUGVyVmlld0xhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICAgICAgY2FyZHNQZXJWaWV3TGFiZWwudGV4dENvbnRlbnQgPSAnQ2FyZHMgUGVyIFZpZXc6JztcbiAgICAgICAgc2V0dGluZ3NQb3B1cC5hcHBlbmRDaGlsZChjYXJkc1BlclZpZXdMYWJlbCk7XG4gICAgICAgIHNldHRpbmdzUG9wdXAuYXBwZW5kQ2hpbGQoY2FyZHNQZXJWaWV3U2V0dGluZyk7XG5cbiAgICAgICAgLy8gXHVBRTAwXHVDNzkwIFx1RDA2Q1x1QUUzMCBcdUMxMjRcdUM4MTVcbiAgICAgICAgY29uc3QgZm9udFNpemVTZXR0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgZm9udFNpemVTZXR0aW5nLnR5cGUgPSAncmFuZ2UnO1xuICAgICAgICBmb250U2l6ZVNldHRpbmcubWluID0gJzEwJztcbiAgICAgICAgZm9udFNpemVTZXR0aW5nLm1heCA9ICczMCc7XG4gICAgICAgIGZvbnRTaXplU2V0dGluZy52YWx1ZSA9IHBsdWdpbi5zZXR0aW5ncy5jb250ZW50U2l6ZS50b1N0cmluZygpO1xuICAgICAgICBmb250U2l6ZVNldHRpbmcuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZUludCgoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUsIDEwKTtcbiAgICAgICAgICAgIHVwZGF0ZVNldHRpbmcoJ2NvbnRlbnRTaXplJywgdmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZm9udFNpemVMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gICAgICAgIGZvbnRTaXplTGFiZWwudGV4dENvbnRlbnQgPSAnQ29udGVudCBGb250IFNpemU6JztcbiAgICAgICAgc2V0dGluZ3NQb3B1cC5hcHBlbmRDaGlsZChmb250U2l6ZUxhYmVsKTtcbiAgICAgICAgc2V0dGluZ3NQb3B1cC5hcHBlbmRDaGlsZChmb250U2l6ZVNldHRpbmcpO1xuXG4gICAgICAgIC8vIFx1RDQ1Q1x1QzJEQyBcdUQ1NkRcdUJBQTkgXHVDMTIwXHVEMEREXHVDNzQ0IFx1QzcwNFx1RDU1QyBcdUQxQTBcdUFFMDAgXHVCQzg0XHVEMkJDXHVCNEU0XG4gICAgICAgIGNvbnN0IGNyZWF0ZVRvZ2dsZSA9IChsYWJlbFRleHQ6IHN0cmluZywgc2V0dGluZ0tleToga2V5b2YgQ2FyZE5hdmlnYXRvclNldHRpbmdzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICAgICAgICAgIGxhYmVsLnRleHRDb250ZW50ID0gbGFiZWxUZXh0O1xuXG4gICAgICAgICAgICBjb25zdCB0b2dnbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICAgICAgdG9nZ2xlLnR5cGUgPSAnY2hlY2tib3gnO1xuICAgICAgICAgICAgdG9nZ2xlLmNoZWNrZWQgPSBwbHVnaW4uc2V0dGluZ3Nbc2V0dGluZ0tleV0gYXMgYm9vbGVhbjtcbiAgICAgICAgICAgIHRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIHVwZGF0ZVNldHRpbmcoc2V0dGluZ0tleSwgKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmNoZWNrZWQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChsYWJlbCk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodG9nZ2xlKTtcbiAgICAgICAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gRmlsZSBOYW1lIFx1RDQ1Q1x1QzJEQ1xuICAgICAgICBjb25zdCBmaWxlTmFtZVRvZ2dsZSA9IGNyZWF0ZVRvZ2dsZSgnU2hvdyBGaWxlIE5hbWUnLCAnc2hvd0ZpbGVOYW1lJyk7XG4gICAgICAgIHNldHRpbmdzUG9wdXAuYXBwZW5kQ2hpbGQoZmlsZU5hbWVUb2dnbGUpO1xuXG4gICAgICAgIC8vIEZpcnN0IEhlYWRlciBcdUQ0NUNcdUMyRENcbiAgICAgICAgY29uc3QgZmlyc3RIZWFkZXJUb2dnbGUgPSBjcmVhdGVUb2dnbGUoJ1Nob3cgRmlyc3QgSGVhZGVyJywgJ3Nob3dGaXJzdEhlYWRlcicpO1xuICAgICAgICBzZXR0aW5nc1BvcHVwLmFwcGVuZENoaWxkKGZpcnN0SGVhZGVyVG9nZ2xlKTtcblxuICAgICAgICAvLyBDb250ZW50IFx1RDQ1Q1x1QzJEQ1xuICAgICAgICBjb25zdCBjb250ZW50VG9nZ2xlID0gY3JlYXRlVG9nZ2xlKCdTaG93IENvbnRlbnQnLCAnc2hvd0NvbnRlbnQnKTtcbiAgICAgICAgc2V0dGluZ3NQb3B1cC5hcHBlbmRDaGlsZChjb250ZW50VG9nZ2xlKTtcblxuICAgICAgICAvLyBEcmFnIGFuZCBEcm9wIENvbnRlbnQgXHVENDVDXHVDMkRDXG4gICAgICAgIGNvbnN0IGRyYWdEcm9wQ29udGVudFRvZ2dsZSA9IGNyZWF0ZVRvZ2dsZSgnRHJhZyBhbmQgRHJvcCBDb250ZW50JywgJ2RyYWdEcm9wQ29udGVudCcpO1xuICAgICAgICBzZXR0aW5nc1BvcHVwLmFwcGVuZENoaWxkKGRyYWdEcm9wQ29udGVudFRvZ2dsZSk7XG5cbiAgICAgICAgLy8gXHVEMjM0XHVCQzE0IFx1RDU1OFx1QjJFOFx1QzVEMCBcdUJDMzBcdUNFNThcbiAgICAgICAgY29uc3QgdG9vbGJhckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmQtbmF2aWdhdG9yLXRvb2xiYXItY29udGFpbmVyJyk7XG4gICAgICAgIGlmICh0b29sYmFyRWwpIHtcbiAgICAgICAgICAgIHRvb2xiYXJFbC5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgc2V0dGluZ3NQb3B1cCk7XG5cbiAgICAgICAgICAgIC8vIFx1RDY1NFx1QkE3NFx1Qzc1OCBcdUIyRTRcdUI5NzggXHVBQ0YzXHVDNzQ0IFx1RDA3NFx1QjlBRFx1RDU1OFx1QkE3NCBcdUQzMURcdUM1QzVcdUM3NDQgXHVCMkVCXHVCMjk0IFx1Qzc3NFx1QkNBNFx1RDJCOCBcdUNEOTRcdUFDMDBcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gb25DbGlja091dHNpZGUoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3NQb3B1cCAmJiAhc2V0dGluZ3NQb3B1cC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkgJiYgIXRvb2xiYXJFbC5jb250YWlucyhldmVudC50YXJnZXQgYXMgTm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NQb3B1cC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsaWNrT3V0c2lkZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBzZXR0aW5nc1BvcHVwLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICAgIH1cbn1cbiIsICIvLyBzcmMvdWkvY2FyZENvbnRhaW5lci9jYXJkQ29udGFpbmVyLnRzXG5cbmltcG9ydCB7IFdvcmtzcGFjZUxlYWYsIFRGaWxlLCBURm9sZGVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgQ2FyZE5hdmlnYXRvclBsdWdpbiBmcm9tICdtYWluJztcbmltcG9ydCB7IENhcmRNYWtlciB9IGZyb20gJy4vY2FyZE1ha2VyJ1xuaW1wb3J0IHsgc29ydEZpbGVzIH0gZnJvbSAnLi4vLi4vY29tbW9uL3V0aWxzJztcbmltcG9ydCB7IENhcmQsIFNvcnRDcml0ZXJpb24gfSBmcm9tICcuLi8uLi9jb21tb24vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgQ2FyZENvbnRhaW5lciB7XG4gICAgcHJpdmF0ZSBsZWFmOiBXb3Jrc3BhY2VMZWFmO1xuICAgIHByaXZhdGUgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBjYXJkTWFrZXI6IENhcmRNYWtlcjtcbiAgICBwcml2YXRlIHBsdWdpbjogQ2FyZE5hdmlnYXRvclBsdWdpbjtcbiAgICBwdWJsaWMgaXNWZXJ0aWNhbDogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvb2xiYXJIZWlnaHQ6IG51bWJlcjtcbiAgICBwcml2YXRlIGNhcmRHYXA6IG51bWJlcjtcbiAgICBwcml2YXRlIGNvbnRhaW5lclBhZGRpbmc6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogQ2FyZE5hdmlnYXRvclBsdWdpbiwgbGVhZjogV29ya3NwYWNlTGVhZikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5sZWFmID0gbGVhZjtcbiAgICAgICAgdGhpcy5jYXJkTWFrZXIgPSBuZXcgQ2FyZE1ha2VyKHRoaXMucGx1Z2luKTtcbiAgICAgICAgdGhpcy5pc1ZlcnRpY2FsID0gZmFsc2U7XG4gICAgICAgIHRoaXMudG9vbGJhckhlaWdodCA9IHRoaXMuZ2V0Q1NTVmFyaWFibGUoJy0tY2FyZC1uYXZpZ2F0b3ItdG9vbGJhci1oZWlnaHQnLCA1MCk7XG4gICAgICAgIHRoaXMuY2FyZEdhcCA9IHRoaXMuZ2V0Q1NTVmFyaWFibGUoJy0tY2FyZC1uYXZpZ2F0b3ItZ2FwJywgMTApO1xuICAgICAgICB0aGlzLmNvbnRhaW5lclBhZGRpbmcgPSB0aGlzLmdldENTU1ZhcmlhYmxlKCctLWNhcmQtbmF2aWdhdG9yLWNvbnRhaW5lci1wYWRkaW5nJywgMTApO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Q1NTVmFyaWFibGUodmFyaWFibGVOYW1lOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgdmFsdWVTdHIgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudClcbiAgICAgICAgICAgIC5nZXRQcm9wZXJ0eVZhbHVlKHZhcmlhYmxlTmFtZSlcbiAgICAgICAgICAgIC50cmltKCk7XG4gICAgICAgIHJldHVybiBwYXJzZUludCh2YWx1ZVN0cikgfHwgZGVmYXVsdFZhbHVlO1xuICAgIH1cblxuICAgIGFzeW5jIGluaXRpYWxpemUoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwgPSBjb250YWluZXJFbDtcbiAgICAgICAgYXdhaXQgdGhpcy53YWl0Rm9yTGVhZkNyZWF0aW9uKCk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcbiAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTdHlsZSgpO1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9XG5cblx0cHJpdmF0ZSBhc3luYyB3YWl0Rm9yTGVhZkNyZWF0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuXHRcdFx0Y29uc3QgY2hlY2tMZWFmID0gKCkgPT4ge1xuXHRcdFx0XHRpZiAodGhpcy5jb250YWluZXJFbCAmJiB0aGlzLmNvbnRhaW5lckVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID4gMCAmJiB0aGlzLmNvbnRhaW5lckVsLmNsaWVudEhlaWdodCA+IDApIHtcblx0XHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNoZWNrTGVhZik7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHRjaGVja0xlYWYoKTtcblx0XHR9KTtcblx0fVxuXG4gICAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpIHtcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi50cmlnZ2VyUmVmcmVzaCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbignbW9kaWZ5JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnRyaWdnZXJSZWZyZXNoKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH1cblxuXHRzZXRPcmllbnRhdGlvbihpc1ZlcnRpY2FsOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuaXNWZXJ0aWNhbCA9IGlzVmVydGljYWw7XG4gICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyU3R5bGUoKTtcblx0XHR0aGlzLnJlZnJlc2goKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZUNvbnRhaW5lclN0eWxlKCkge1xuICAgICAgICBpZiAodGhpcy5jb250YWluZXJFbCkge1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5jbGFzc0xpc3QuYWRkKCdjYXJkLW5hdmlnYXRvci1jb250YWluZXInKTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuY2xhc3NMaXN0LnRvZ2dsZSgndmVydGljYWwnLCB0aGlzLmlzVmVydGljYWwpO1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5jbGFzc0xpc3QudG9nZ2xlKCdob3Jpem9udGFsJywgIXRoaXMuaXNWZXJ0aWNhbCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNsYXNzTGlzdC50b2dnbGUoJ2ZpeGVkLWhlaWdodCcsIHRoaXMucGx1Z2luLnNldHRpbmdzLmZpeGVkQ2FyZEhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNsYXNzTGlzdC50b2dnbGUoJ2ZsZXhpYmxlLWhlaWdodCcsICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5maXhlZENhcmRIZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyBDU1MgdmFyaWFibGVzXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLnNldFByb3BlcnR5KCctLWNhcmRzLXBlci12aWV3JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2FyZHNQZXJWaWV3LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1jYXJkLW5hdmlnYXRvci1nYXAnLCBgJHt0aGlzLmNhcmRHYXB9cHhgKTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUuc2V0UHJvcGVydHkoJy0tY2FyZC1uYXZpZ2F0b3ItdG9vbGJhci1oZWlnaHQnLCBgJHt0aGlzLnRvb2xiYXJIZWlnaHR9cHhgKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nO1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nO1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUub3ZlcmZsb3dYID0gJ2hpZGRlbic7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5zdHlsZS5oZWlnaHQgPSBgY2FsYygxMDAlIC0gJHt0aGlzLnRvb2xiYXJIZWlnaHR9cHgpYDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLm1hcmdpblRvcCA9IGAke3RoaXMudG9vbGJhckhlaWdodH1weGA7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyRWwuc3R5bGUuZ2FwID0gYCR7dGhpcy5jYXJkR2FwfXB4YDtcblx0XHRcdFx0dGhpcy5jb250YWluZXJFbC5zdHlsZS5tYXJnaW5SaWdodCA9IGAtMTBweGA7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyRWwuc3R5bGUucGFkZGluZ1JpZ2h0ID0gYCR7dGhpcy5jb250YWluZXJQYWRkaW5nfXB4YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5zdHlsZS5mbGV4RGlyZWN0aW9uID0gJ3Jvdyc7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5zdHlsZS5vdmVyZmxvd1ggPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5zdHlsZS5vdmVyZmxvd1kgPSAnaGlkZGVuJztcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLmhlaWdodCA9ICcxMDAlJztcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLm1hcmdpblRvcCA9ICcwJztcblx0XHRcdFx0dGhpcy5jb250YWluZXJFbC5zdHlsZS5nYXAgPSBgJHt0aGlzLmNhcmRHYXB9cHhgO1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUucGFkZGluZ1RvcCA9IGAke3RoaXMuY29udGFpbmVyUGFkZGluZ31weGA7XG5cdFx0XHRcdHRoaXMuY29udGFpbmVyRWwuc3R5bGUucGFkZGluZ0JvdHRvbSA9IGAke3RoaXMuY29udGFpbmVyUGFkZGluZ31weGA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyByZWZyZXNoKCkge1xuICAgICAgICBsZXQgZm9sZGVyOiBURm9sZGVyIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVNlbGVjdGVkRm9sZGVyICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRm9sZGVyKSB7XG4gICAgICAgICAgICBmb2xkZXIgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkRm9sZGVyKSBhcyBURm9sZGVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgZm9sZGVyID0gYWN0aXZlRmlsZT8ucGFyZW50IHx8IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWZvbGRlciB8fCAhdGhpcy5jb250YWluZXJFbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZmlsZXMgPSBmb2xkZXIuY2hpbGRyZW4uZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xuICAgICAgICBjb25zdCBzb3J0ZWRGaWxlcyA9IHNvcnRGaWxlcyhmaWxlcywgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydENyaXRlcmlvbiwgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydE9yZGVyKTtcbiAgICAgICAgY29uc3QgY2FyZHNEYXRhID0gYXdhaXQgUHJvbWlzZS5hbGwoc29ydGVkRmlsZXMubWFwKGZpbGUgPT4gdGhpcy5jYXJkTWFrZXIuY3JlYXRlQ2FyZChmaWxlKSkpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyQ2FyZHMoY2FyZHNEYXRhKTtcbiAgICB9XG5cblx0cHJpdmF0ZSByZW5kZXJDYXJkcyhjYXJkc0RhdGE6IENhcmRbXSkge1xuXHRcdGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbDtcblx0XHRpZiAoIWNvbnRhaW5lckVsKSByZXR1cm47XG5cdFxuXHRcdC8vIFN0b3JlIHRoZSBjdXJyZW50IHNjcm9sbCBwb3NpdGlvblxuXHRcdGNvbnN0IGN1cnJlbnRTY3JvbGxUb3AgPSBjb250YWluZXJFbC5zY3JvbGxUb3A7XG5cdFx0Y29uc3QgY3VycmVudFNjcm9sbExlZnQgPSBjb250YWluZXJFbC5zY3JvbGxMZWZ0O1xuXHRcblx0XHQvLyBGaW5kIHRoZSBhY3RpdmUgY2FyZCdzIGluZGV4IGJlZm9yZSBjbGVhcmluZ1xuXHRcdGNvbnN0IGFjdGl2ZUNhcmRJbmRleCA9IEFycmF5LmZyb20oY29udGFpbmVyRWwuY2hpbGRyZW4pLmZpbmRJbmRleChcblx0XHRcdGNoaWxkID0+IGNoaWxkLmNsYXNzTGlzdC5jb250YWlucygnY2FyZC1uYXZpZ2F0b3ItYWN0aXZlJylcblx0XHQpO1xuXHRcblx0XHRjb250YWluZXJFbC5pbm5lckhUTUwgPSAnJztcblx0XG5cdFx0Y29uc3QgY29udGFpbmVySGVpZ2h0ID0gY29udGFpbmVyRWwuY2xpZW50SGVpZ2h0O1xuXHRcdGNvbnN0IGF2YWlsYWJsZUhlaWdodCA9IGNvbnRhaW5lckhlaWdodCAtIHRoaXMudG9vbGJhckhlaWdodDtcblx0XG5cdFx0Y2FyZHNEYXRhLmZvckVhY2goKGNhcmREYXRhLCBpbmRleCkgPT4ge1xuXHRcdFx0Y29uc3QgY2FyZCA9IHRoaXMuY2FyZE1ha2VyLmNyZWF0ZUNhcmRFbGVtZW50KGNhcmREYXRhKTtcblx0XHRcdGNhcmQuc3R5bGUuZmxleFNocmluayA9ICcwJztcblx0XG5cdFx0XHRpZiAodGhpcy5pc1ZlcnRpY2FsKSB7XG5cdFx0XHRcdGNhcmQuc3R5bGUud2lkdGggPSAnMTAwJSc7XG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5maXhlZENhcmRIZWlnaHQpIHtcblx0XHRcdFx0XHRjYXJkLnN0eWxlLmhlaWdodCA9IGAke2F2YWlsYWJsZUhlaWdodCAvIHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRzUGVyVmlld31weGA7XG5cdFx0XHRcdFx0Y2FyZC5zdHlsZS5vdmVyZmxvdyA9ICdhdXRvJztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjYXJkLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcblx0XHRcdFx0XHRjYXJkLnN0eWxlLm1pbkhlaWdodCA9IGAke2F2YWlsYWJsZUhlaWdodCAvIHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRzUGVyVmlldyAvIDJ9cHhgO1xuXHRcdFx0XHRcdGNhcmQuc3R5bGUubWF4SGVpZ2h0ID0gYCR7YXZhaWxhYmxlSGVpZ2h0IC8gMn1weGA7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNhcmQuc3R5bGUud2lkdGggPSBgJHsxMDAgLyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jYXJkc1BlclZpZXd9JWA7XG5cdFx0XHRcdGNhcmQuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xuXHRcdFx0fVxuXHRcblx0XHRcdGlmIChjYXJkRGF0YS5maWxlID09PSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKSkge1xuXHRcdFx0XHRjYXJkLmNsYXNzTGlzdC5hZGQoJ2NhcmQtbmF2aWdhdG9yLWFjdGl2ZScpO1xuXHRcdFx0fVxuXHRcblx0XHRcdGNvbnRhaW5lckVsLmFwcGVuZENoaWxkKGNhcmQpO1xuXHRcdH0pO1xuXHRcblx0XHQvLyBSZXN0b3JlIHRoZSBzY3JvbGwgcG9zaXRpb25cblx0XHRjb250YWluZXJFbC5zY3JvbGxUb3AgPSBjdXJyZW50U2Nyb2xsVG9wO1xuXHRcdGNvbnRhaW5lckVsLnNjcm9sbExlZnQgPSBjdXJyZW50U2Nyb2xsTGVmdDtcblx0XG5cdFx0Ly8gSWYgdGhlIGFjdGl2ZSBjYXJkIGhhcyBtb3ZlZCwgc2Nyb2xsIHRvIGl0XG5cdFx0Y29uc3QgbmV3QWN0aXZlQ2FyZEluZGV4ID0gQXJyYXkuZnJvbShjb250YWluZXJFbC5jaGlsZHJlbikuZmluZEluZGV4KFxuXHRcdFx0Y2hpbGQgPT4gY2hpbGQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkLW5hdmlnYXRvci1hY3RpdmUnKVxuXHRcdCk7XG5cdFxuXHRcdGlmIChhY3RpdmVDYXJkSW5kZXggIT09IG5ld0FjdGl2ZUNhcmRJbmRleCAmJiBuZXdBY3RpdmVDYXJkSW5kZXggIT09IC0xKSB7XG5cdFx0XHR0aGlzLnNjcm9sbFRvQWN0aXZlQ2FyZChmYWxzZSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRwcml2YXRlIHNjcm9sbFRvQWN0aXZlQ2FyZChhbmltYXRlID0gdHJ1ZSkge1xuXHRcdGlmICghdGhpcy5jb250YWluZXJFbCkgcmV0dXJuO1xuXHRcdGNvbnN0IGFjdGl2ZUNhcmQgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkLW5hdmlnYXRvci1hY3RpdmUnKSBhcyBIVE1MRWxlbWVudCB8IG51bGw7XG5cdFx0aWYgKCFhY3RpdmVDYXJkKSByZXR1cm47XG5cdFxuXHRcdGNvbnN0IGNvbnRhaW5lclJlY3QgPSB0aGlzLmNvbnRhaW5lckVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdGNvbnN0IGFjdGl2ZUNhcmRSZWN0ID0gYWN0aXZlQ2FyZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XG5cdFx0bGV0IG9mZnNldCA9IDA7XG5cdFx0bGV0IHNjcm9sbFByb3BlcnR5OiAnc2Nyb2xsVG9wJyB8ICdzY3JvbGxMZWZ0Jztcblx0XG5cdFx0aWYgKHRoaXMuaXNWZXJ0aWNhbCkge1xuXHRcdFx0Y29uc3QgY29udGFpbmVyQ2VudGVyID0gY29udGFpbmVyUmVjdC50b3AgKyBjb250YWluZXJSZWN0LmhlaWdodCAvIDI7XG5cdFx0XHRjb25zdCBjYXJkQ2VudGVyID0gYWN0aXZlQ2FyZFJlY3QudG9wICsgYWN0aXZlQ2FyZFJlY3QuaGVpZ2h0IC8gMjtcblx0XHRcdG9mZnNldCA9IGNhcmRDZW50ZXIgLSBjb250YWluZXJDZW50ZXI7XG5cdFx0XHRzY3JvbGxQcm9wZXJ0eSA9ICdzY3JvbGxUb3AnO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBjb250YWluZXJDZW50ZXIgPSBjb250YWluZXJSZWN0LmxlZnQgKyBjb250YWluZXJSZWN0LndpZHRoIC8gMjtcblx0XHRcdGNvbnN0IGNhcmRDZW50ZXIgPSBhY3RpdmVDYXJkUmVjdC5sZWZ0ICsgYWN0aXZlQ2FyZFJlY3Qud2lkdGggLyAyO1xuXHRcdFx0b2Zmc2V0ID0gY2FyZENlbnRlciAtIGNvbnRhaW5lckNlbnRlcjtcblx0XHRcdHNjcm9sbFByb3BlcnR5ID0gJ3Njcm9sbExlZnQnO1xuXHRcdH1cblx0XG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGNhcmQgaXMgYWxyZWFkeSBpbiB2aWV3XG5cdFx0Y29uc3QgdGhyZXNob2xkID0gNTA7IC8vIHB4XG5cdFx0aWYgKE1hdGguYWJzKG9mZnNldCkgPCB0aHJlc2hvbGQpIHJldHVybjtcblx0XG5cdFx0Ly8gQ2FsY3VsYXRlIHRoZSBuZXcgc2Nyb2xsIHBvc2l0aW9uXG5cdFx0Y29uc3QgbmV3U2Nyb2xsUG9zaXRpb24gPSB0aGlzLmNvbnRhaW5lckVsW3Njcm9sbFByb3BlcnR5XSArIG9mZnNldDtcblx0XG5cdFx0aWYgKGFuaW1hdGUpIHtcblx0XHRcdC8vIEFuaW1hdGUgdGhlIHNjcm9sbFxuXHRcdFx0Y29uc3Qgc3RhcnQgPSB0aGlzLmNvbnRhaW5lckVsW3Njcm9sbFByb3BlcnR5XTtcblx0XHRcdGNvbnN0IGNoYW5nZSA9IG5ld1Njcm9sbFBvc2l0aW9uIC0gc3RhcnQ7XG5cdFx0XHRjb25zdCBkdXJhdGlvbiA9IDMwMDsgLy8gbXNcblx0XHRcdGxldCBzdGFydFRpbWU6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXHRcblx0XHRcdGNvbnN0IGFuaW1hdGVTY3JvbGwgPSAoY3VycmVudFRpbWU6IG51bWJlcikgPT4ge1xuXHRcdFx0XHRpZiAoc3RhcnRUaW1lID09PSBudWxsKSBzdGFydFRpbWUgPSBjdXJyZW50VGltZTtcblx0XHRcdFx0Y29uc3QgdGltZUVsYXBzZWQgPSBjdXJyZW50VGltZSAtIHN0YXJ0VGltZTtcblx0XHRcdFx0Y29uc3QgcHJvZ3Jlc3MgPSBNYXRoLm1pbih0aW1lRWxhcHNlZCAvIGR1cmF0aW9uLCAxKTtcblx0XHRcdFx0Y29uc3QgZWFzZVByb2dyZXNzID0gMC41IC0gTWF0aC5jb3MocHJvZ3Jlc3MgKiBNYXRoLlBJKSAvIDI7IC8vIGVhc2VJbk91dFNpbmVcblx0XG5cdFx0XHRcdGlmICh0aGlzLmNvbnRhaW5lckVsKSB7XG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJFbFtzY3JvbGxQcm9wZXJ0eV0gPSBzdGFydCArIGNoYW5nZSAqIGVhc2VQcm9ncmVzcztcblx0XHRcdFx0fVxuXHRcblx0XHRcdFx0aWYgKHRpbWVFbGFwc2VkIDwgZHVyYXRpb24gJiYgdGhpcy5jb250YWluZXJFbCkge1xuXHRcdFx0XHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlU2Nyb2xsKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XG5cdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZVNjcm9sbCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEluc3RhbnQgc2Nyb2xsIHdpdGhvdXQgYW5pbWF0aW9uXG5cdFx0XHR0aGlzLmNvbnRhaW5lckVsW3Njcm9sbFByb3BlcnR5XSA9IG5ld1Njcm9sbFBvc2l0aW9uO1xuXHRcdH1cblx0fVxuXHRcblx0cHVibGljIGNlbnRlckFjdGl2ZUNhcmQoKSB7XG5cdFx0dGhpcy5zY3JvbGxUb0FjdGl2ZUNhcmQodHJ1ZSk7XG5cdH1cblxuICAgIHNjcm9sbFVwKGNvdW50ID0gMSkge1xuICAgICAgICBpZiAoIXRoaXMuY29udGFpbmVyRWwpIHJldHVybjtcbiAgICAgICAgaWYgKHRoaXMuaXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsQW1vdW50ID0gdGhpcy5nZXRDYXJkSGVpZ2h0KCkgKiBjb3VudDtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuc2Nyb2xsQnkoeyB0b3A6IC1zY3JvbGxBbW91bnQsIGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFx1QUMwMFx1Qjg1QyBcdUJBQThcdUI0RENcdUM1RDBcdUMxMUNcdUIyOTQgXHVDNjdDXHVDQUJEXHVDNzNDXHVCODVDIFx1QzJBNFx1RDA2Q1x1Qjg2NFxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsQW1vdW50ID0gdGhpcy5nZXRDYXJkV2lkdGgoKSAqIGNvdW50O1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5zY3JvbGxCeSh7IGxlZnQ6IC1zY3JvbGxBbW91bnQsIGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNjcm9sbERvd24oY291bnQgPSAxKSB7XG4gICAgICAgIGlmICghdGhpcy5jb250YWluZXJFbCkgcmV0dXJuO1xuICAgICAgICBpZiAodGhpcy5pc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICBjb25zdCBzY3JvbGxBbW91bnQgPSB0aGlzLmdldENhcmRIZWlnaHQoKSAqIGNvdW50O1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5zY3JvbGxCeSh7IHRvcDogc2Nyb2xsQW1vdW50LCBiZWhhdmlvcjogJ3Ntb290aCcgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBcdUFDMDBcdUI4NUMgXHVCQUE4XHVCNERDXHVDNUQwXHVDMTFDXHVCMjk0IFx1QzYyNFx1Qjk3OFx1Q0FCRFx1QzczQ1x1Qjg1QyBcdUMyQTRcdUQwNkNcdUI4NjRcbiAgICAgICAgICAgIGNvbnN0IHNjcm9sbEFtb3VudCA9IHRoaXMuZ2V0Q2FyZFdpZHRoKCkgKiBjb3VudDtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuc2Nyb2xsQnkoeyBsZWZ0OiBzY3JvbGxBbW91bnQsIGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNjcm9sbExlZnQoY291bnQgPSAxKSB7XG4gICAgICAgIGlmICghdGhpcy5jb250YWluZXJFbCkgcmV0dXJuO1xuICAgICAgICBjb25zdCBzY3JvbGxBbW91bnQgPSB0aGlzLmdldENhcmRXaWR0aCgpICogY291bnQ7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuc2Nyb2xsQnkoeyBsZWZ0OiAtc2Nyb2xsQW1vdW50LCBiZWhhdmlvcjogJ3Ntb290aCcgfSk7XG4gICAgfVxuXG4gICAgc2Nyb2xsUmlnaHQoY291bnQgPSAxKSB7XG4gICAgICAgIGlmICghdGhpcy5jb250YWluZXJFbCkgcmV0dXJuO1xuICAgICAgICBjb25zdCBzY3JvbGxBbW91bnQgPSB0aGlzLmdldENhcmRXaWR0aCgpICogY291bnQ7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuc2Nyb2xsQnkoeyBsZWZ0OiBzY3JvbGxBbW91bnQsIGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldENhcmRIZWlnaHQoKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnRhaW5lckVsKSByZXR1cm4gMDtcbiAgICAgICAgY29uc3QgZmlyc3RDYXJkID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcuY2FyZC1uYXZpZ2F0b3ItY2FyZCcpO1xuICAgICAgICByZXR1cm4gZmlyc3RDYXJkID8gZmlyc3RDYXJkLmNsaWVudEhlaWdodCA6IDA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRDYXJkV2lkdGgoKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnRhaW5lckVsKSByZXR1cm4gMDtcbiAgICAgICAgY29uc3QgZmlyc3RDYXJkID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcuY2FyZC1uYXZpZ2F0b3ItY2FyZCcpO1xuICAgICAgICByZXR1cm4gZmlyc3RDYXJkID8gZmlyc3RDYXJkLmNsaWVudFdpZHRoIDogMDtcbiAgICB9XG5cbiAgICBzY3JvbGxUb0NlbnRlcigpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxUb0FjdGl2ZUNhcmQoKTtcbiAgICB9XG5cblx0cHVibGljIGRpc3BsYXlDYXJkcyhmaWx0ZXJlZEZpbGVzOiBURmlsZVtdKSB7XG5cdH1cblxuICAgIHB1YmxpYyBhc3luYyBzZWFyY2hDYXJkcyhzZWFyY2hUZXJtOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBpZiAoIWFjdGl2ZUZpbGUpIHJldHVybjtcblxuICAgICAgICBjb25zdCBmb2xkZXIgPSBhY3RpdmVGaWxlLnBhcmVudDtcbiAgICAgICAgaWYgKCFmb2xkZXIpIHJldHVybjtcblxuICAgICAgICBjb25zdCBmaWxlcyA9IGZvbGRlci5jaGlsZHJlbi5maWx0ZXIoKGZpbGUpOiBmaWxlIGlzIFRGaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURmlsZSk7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRmlsZXMgPSBhd2FpdCB0aGlzLmZpbHRlckZpbGVzQnlDb250ZW50KGZpbGVzLCBzZWFyY2hUZXJtKTtcblxuICAgICAgICBjb25zdCBjYXJkcyA9IGF3YWl0IFByb21pc2UuYWxsKGZpbHRlcmVkRmlsZXMubWFwKGZpbGUgPT4gdGhpcy5jYXJkTWFrZXIuY3JlYXRlQ2FyZChmaWxlKSkpO1xuICAgICAgICB0aGlzLnJlbmRlckNhcmRzKGNhcmRzKTtcbiAgICB9XG5cbiAgICBhc3luYyBkaXNwbGF5Q2FyZHNGb3JGb2xkZXIoZm9sZGVyOiBURm9sZGVyKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzID0gZm9sZGVyLmNoaWxkcmVuLmZpbHRlcigoZmlsZSk6IGZpbGUgaXMgVEZpbGUgPT4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlKTtcbiAgICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBQcm9taXNlLmFsbChmaWxlcy5tYXAoZmlsZSA9PiB0aGlzLmNhcmRNYWtlci5jcmVhdGVDYXJkKGZpbGUpKSk7XG4gICAgICAgIHRoaXMucmVuZGVyQ2FyZHMoY2FyZHMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZmlsdGVyRmlsZXNCeUNvbnRlbnQoZmlsZXM6IFRGaWxlW10sIHNlYXJjaFRlcm06IHN0cmluZyk6IFByb21pc2U8VEZpbGVbXT4ge1xuICAgICAgICBjb25zdCBsb3dlcmNhc2VTZWFyY2hUZXJtID0gc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZEZpbGVzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuICAgICAgICAgICAgaWYgKGZpbGUuYmFzZW5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlcmNhc2VTZWFyY2hUZXJtKSB8fFxuICAgICAgICAgICAgICAgIGNvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlcmNhc2VTZWFyY2hUZXJtKSkge1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkRmlsZXMucHVzaChmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsdGVyZWRGaWxlcztcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc29ydENhcmRzKGNyaXRlcmlvbjogU29ydENyaXRlcmlvbiwgb3JkZXI6ICdhc2MnIHwgJ2Rlc2MnKSB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNvcnRDcml0ZXJpb24gPSBjcml0ZXJpb247XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNvcnRPcmRlciA9IG9yZGVyO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy5wbHVnaW4udHJpZ2dlclJlZnJlc2goKTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge31cbn1cbiIsICIvLyBzcmMvdWkvY2FyZENvbnRhaW5lci9jYXJkTWFrZXIudHNcblxuaW1wb3J0IHsgTWVudSwgVEZpbGUsIE1hcmtkb3duUmVuZGVyZXIgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgQ2FyZE5hdmlnYXRvclBsdWdpbiBmcm9tICcuLi8uLi9tYWluJztcbmltcG9ydCB7IENhcmQgfSBmcm9tICcuLi8uLi9jb21tb24vdHlwZXMnO1xuaW1wb3J0IHsgc29ydEZpbGVzLCBzZXBhcmF0ZUZyb250bWF0dGVyQW5kQ29udGVudCB9IGZyb20gJy4uLy4uL2NvbW1vbi91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBDYXJkTWFrZXIge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBDYXJkTmF2aWdhdG9yUGx1Z2luKSB7fVxuXG5cdGFzeW5jIGdldENhcmRzRm9yQWN0aXZlRmlsZShhY3RpdmVGaWxlOiBURmlsZSk6IFByb21pc2U8Q2FyZFtdPiB7XG5cdFx0Y29uc3QgZm9sZGVyID0gYWN0aXZlRmlsZS5wYXJlbnQ7XG5cdFx0aWYgKCFmb2xkZXIpIHtcblx0XHRcdHJldHVybiBbXTtcblx0XHR9XG5cdFx0Y29uc3QgZmlsZXMgPSBmb2xkZXIuY2hpbGRyZW4uZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xuXHRcdGNvbnN0IHNvcnRlZEZpbGVzID0gc29ydEZpbGVzKFxuXHRcdFx0ZmlsZXMsIFxuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydENyaXRlcmlvbiwgXG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zb3J0T3JkZXJcblx0XHQpO1xuXHRcdHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChzb3J0ZWRGaWxlcy5tYXAoZmlsZSA9PiB0aGlzLmNyZWF0ZUNhcmQoZmlsZSkpKTtcblx0fVxuXG4gICAgcHVibGljIGFzeW5jIGNyZWF0ZUNhcmQoZmlsZTogVEZpbGUpOiBQcm9taXNlPENhcmQ+IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuICAgICAgICBjb25zdCB7IGNsZWFuQ29udGVudCB9ID0gc2VwYXJhdGVGcm9udG1hdHRlckFuZENvbnRlbnQoY29udGVudCk7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRXaXRob3V0SGVhZGVyID0gdGhpcy5yZW1vdmVGaXJzdEhlYWRlcihjbGVhbkNvbnRlbnQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgIGZpbGVOYW1lOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93RmlsZU5hbWUgPyBmaWxlLmJhc2VuYW1lIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZmlyc3RIZWFkZXI6IHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dGaXJzdEhlYWRlciA/IHRoaXMuZmluZEZpcnN0SGVhZGVyKGNsZWFuQ29udGVudCkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBjb250ZW50OiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29udGVudCA/IHRoaXMudHJ1bmNhdGVDb250ZW50KGNvbnRlbnRXaXRob3V0SGVhZGVyKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbW92ZUZpcnN0SGVhZGVyKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGhlYWRlclJlZ2V4ID0gL14jK1xccysoLispJC9tO1xuICAgICAgICByZXR1cm4gY29udGVudC5yZXBsYWNlKGhlYWRlclJlZ2V4LCAnJykudHJpbSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZmluZEZpcnN0SGVhZGVyKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IGhlYWRlclJlZ2V4ID0gL14jK1xccysoLispJC9tO1xuICAgICAgICBjb25zdCBtYXRjaCA9IGNvbnRlbnQubWF0Y2goaGVhZGVyUmVnZXgpO1xuICAgICAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXS50cmltKCkgOiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB0cnVuY2F0ZUNvbnRlbnQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudExlbmd0aCAqIDEwMDtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQubGVuZ3RoIDw9IG1heExlbmd0aCA/IGNvbnRlbnQgOiBjb250ZW50LnNsaWNlKDAsIG1heExlbmd0aCkgKyAnLi4uJztcbiAgICB9XG5cbiAgICBjcmVhdGVDYXJkRWxlbWVudChjYXJkOiBDYXJkKTogSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjYXJkRWxlbWVudC5jbGFzc05hbWUgPSAnY2FyZC1uYXZpZ2F0b3ItY2FyZCc7XG5cbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dGaWxlTmFtZSAmJiBjYXJkLmZpbGVOYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlTmFtZUVsID0gY2FyZEVsZW1lbnQuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiBjYXJkLmZpbGVOYW1lIH0pO1xuICAgICAgICAgICAgZmlsZU5hbWVFbC5jbGFzc05hbWUgPSAnY2FyZC1uYXZpZ2F0b3ItZmlsZW5hbWUnO1xuICAgICAgICAgICAgZmlsZU5hbWVFbC5zdHlsZS5mb250U2l6ZSA9IGAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVOYW1lU2l6ZX1weGA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0ZpcnN0SGVhZGVyICYmIGNhcmQuZmlyc3RIZWFkZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlckVsID0gY2FyZEVsZW1lbnQuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiBjYXJkLmZpcnN0SGVhZGVyIH0pO1xuICAgICAgICAgICAgaGVhZGVyRWwuY2xhc3NOYW1lID0gJ2NhcmQtbmF2aWdhdG9yLWZpcnN0LWhlYWRlcic7XG4gICAgICAgICAgICBoZWFkZXJFbC5zdHlsZS5mb250U2l6ZSA9IGAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0SGVhZGVyU2l6ZX1weGA7XG4gICAgICAgIH1cblxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93Q29udGVudCAmJiBjYXJkLmNvbnRlbnQpIHtcblx0XHRcdGNvbnN0IGNvbnRlbnRFbCA9IGNhcmRFbGVtZW50LmNyZWF0ZUVsKCdkaXYnKTtcblx0XHRcdGNvbnRlbnRFbC5jbGFzc05hbWUgPSAnY2FyZC1uYXZpZ2F0b3ItY29udGVudCc7XG5cdFx0XHRjb250ZW50RWwuc3R5bGUuZm9udFNpemUgPSBgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50U2l6ZX1weGA7XG5cdFx0XG5cdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVuZGVyQ29udGVudEFzSHRtbCkge1xuXHRcdFx0XHRNYXJrZG93blJlbmRlcmVyLnJlbmRlcihcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5hcHAsXG5cdFx0XHRcdFx0Y2FyZC5jb250ZW50LFxuXHRcdFx0XHRcdGNvbnRlbnRFbCxcblx0XHRcdFx0XHRjYXJkLmZpbGUucGF0aCxcblx0XHRcdFx0XHR0aGlzLnBsdWdpblxuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29udGVudEVsLnRleHRDb250ZW50ID0gY2FyZC5jb250ZW50O1xuXHRcdFx0XHRjb250ZW50RWwuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcblx0XHRcdFx0Y29udGVudEVsLnN0eWxlLnRleHRPdmVyZmxvdyA9ICdlbGxpcHNpcyc7XG5cdFx0XHRcdGNvbnRlbnRFbC5zdHlsZS5kaXNwbGF5ID0gJy13ZWJraXQtYm94Jztcblx0XHRcdH1cblx0XHR9XG5cbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpID09PSBjYXJkLmZpbGUpIHtcbiAgICAgICAgICAgIGNhcmRFbGVtZW50LmFkZENsYXNzKCdjYXJkLW5hdmlnYXRvci1hY3RpdmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFx1Q0U3NFx1QjREQyBcdUMwRERcdUMxMzEgXHVENkM0IFx1QjREQ1x1Qjc5OFx1QURGOCBcdUM1NjQgXHVCNERDXHVCODZEIFx1QkMwRiBcdUIyRTRcdUI5NzggXHVDNzc4XHVEMTMwXHVCNzk5XHVDMTU4IFx1QzEyNFx1QzgxNVxuICAgICAgICB0aGlzLmFkZENhcmRJbnRlcmFjdGlvbnMoY2FyZEVsZW1lbnQsIGNhcmQpO1xuXG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFkZENhcmRJbnRlcmFjdGlvbnMoY2FyZEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBjYXJkOiBDYXJkKSB7XG4gICAgICAgIGNhcmRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5vcGVuRmlsZShjYXJkLmZpbGUpKTtcbiAgICAgICAgdGhpcy5zZXR1cERyYWdBbmREcm9wKGNhcmRFbGVtZW50LCBjYXJkKTtcbiAgICAgICAgdGhpcy5zZXR1cENvbnRleHRNZW51KGNhcmRFbGVtZW50LCBjYXJkLmZpbGUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0dXBEcmFnQW5kRHJvcChjYXJkRWxlbWVudDogSFRNTEVsZW1lbnQsIGNhcmQ6IENhcmQpIHtcbiAgICAgICAgY2FyZEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCAndHJ1ZScpO1xuICAgICAgICBjYXJkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIpIHtcbiAgICAgICAgICAgICAgICBsZXQgZHJhZ0NvbnRlbnQgPSAnJztcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kcmFnRHJvcENvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gXHVDRTc0XHVCNERDXHVDNUQwIFx1RDQ1Q1x1QzJEQ1x1QjQxOFx1QjI5NCBcdUQ1NkRcdUJBQTlcdUM1RDAgXHVCNTMwXHVCNzdDIFx1QjREQ1x1Qjc5OFx1QURGOCBcdUM1NjQgXHVCNERDXHVCODZEIFx1QzJEQyBcdUMwQkRcdUM3ODVcdUQ1NjAgXHVCMEI0XHVDNkE5IFx1QUNCMFx1QzgxNVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0ZpbGVOYW1lICYmIGNhcmQuZmlsZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdDb250ZW50ICs9IGAjIyAke2NhcmQuZmlsZU5hbWV9XFxuXFxuYDsgLy8gXHVEMzBDXHVDNzdDXHVCQTg1IFx1QzU1RVx1QzVEMCBcdUQ1RTRcdUIzNTQgXHVDRDk0XHVBQzAwXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0ZpcnN0SGVhZGVyICYmIGNhcmQuZmlyc3RIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdDb250ZW50ICs9IGAjICR7Y2FyZC5maXJzdEhlYWRlcn1cXG5cXG5gOyAvLyBcdUNDQUIgXHVCQzg4XHVDOUY4IFx1RDVFNFx1QjM1NCBcdUM1NUVcdUM1RDAgXHVENUU0XHVCMzU0IFx1Q0Q5NFx1QUMwMFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dDb250ZW50ICYmIGNhcmQuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ0NvbnRlbnQgKz0gYCR7Y2FyZC5jb250ZW50fVxcblxcbmA7IC8vIFx1QkNGOFx1QkIzOCBcdUIwQjRcdUM2QTkgXHVDRDk0XHVBQzAwXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZHJhZ0NvbnRlbnQgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBcdUI5Q0NcdUM1N0QgXHVENDVDXHVDMkRDIFx1QzEyNFx1QzgxNVx1Qzc3NCBcdUI0MThcdUM1QjRcdUM3ODhcdUM5QzAgXHVDNTRBXHVDNzNDXHVCQTc0IFx1QUUzMFx1QkNGOCBcdUQzMENcdUM3N0MgXHVCOUMxXHVEMDZDIFx1QzBCRFx1Qzc4NVxuICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ0NvbnRlbnQgPSBgW1ske2NhcmQuZmlsZS5uYW1lfV1dYDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFwiRHJhZyBhbmQgRHJvcCBDb250ZW50XCIgXHVDNjM1XHVDMTU4XHVDNzc0IFx1QkU0NFx1RDY1Q1x1QzEzMVx1RDY1NFx1QjQxQyBcdUFDQkRcdUM2QjAgXHVEMzBDXHVDNzdDXHVCQTg1IFx1QjlDMVx1RDA2Q1x1Qjk3QyBcdUMwQkRcdUM3ODVcbiAgICAgICAgICAgICAgICAgICAgZHJhZ0NvbnRlbnQgPSBgW1ske2NhcmQuZmlsZS5uYW1lfV1dYDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSgndGV4dC9wbGFpbicsIGRyYWdDb250ZW50LnRyaW0oKSk7XG5cdFx0XHRcdGV2ZW50LmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UoY2FyZEVsZW1lbnQsIDAsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldHVwQ29udGV4dE1lbnUoY2FyZEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBmaWxlOiBURmlsZSkge1xuICAgICAgICBjYXJkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCBtZW51ID0gbmV3IE1lbnUoKTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UudHJpZ2dlcignZmlsZS1tZW51JywgbWVudSwgZmlsZSwgJ21vcmUtb3B0aW9ucycpO1xuICAgICAgICAgICAgbWVudS5zaG93QXRQb3NpdGlvbih7IHg6IGUuY2xpZW50WCwgeTogZS5jbGllbnRZIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9wZW5GaWxlKGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKGZpbGUpO1xuICAgIH1cbn1cbiIsICIvLyBzcmMvY29tbW9uL3V0aWxzLnRzXG5cbmltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgU29ydENyaXRlcmlvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgZnVuY3Rpb24gc2VwYXJhdGVGcm9udG1hdHRlckFuZENvbnRlbnQoY29udGVudDogc3RyaW5nKTogeyBmcm9udG1hdHRlcjogc3RyaW5nIHwgbnVsbCwgY2xlYW5Db250ZW50OiBzdHJpbmcgfSB7XG4gICAgY29uc3QgZnJvbnRtYXR0ZXJSZWdleCA9IC9eLS0tXFxzKlxcbihbXFxzXFxTXSo/KVxcbi0tLVxccypcXG4vO1xuICAgIGNvbnN0IG1hdGNoID0gY29udGVudC5tYXRjaChmcm9udG1hdHRlclJlZ2V4KTtcbiAgICByZXR1cm4gbWF0Y2hcbiAgICAgICAgPyB7IGZyb250bWF0dGVyOiBtYXRjaFsxXSwgY2xlYW5Db250ZW50OiBjb250ZW50LnNsaWNlKG1hdGNoWzBdLmxlbmd0aCkudHJpbSgpIH1cbiAgICAgICAgOiB7IGZyb250bWF0dGVyOiBudWxsLCBjbGVhbkNvbnRlbnQ6IGNvbnRlbnQudHJpbSgpIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzb3J0RmlsZXMoZmlsZXM6IFRGaWxlW10sIGNyaXRlcmlvbjogU29ydENyaXRlcmlvbiwgb3JkZXI6ICdhc2MnIHwgJ2Rlc2MnKTogVEZpbGVbXSB7XG4gICAgcmV0dXJuIGZpbGVzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgbGV0IGNvbXBhcmlzb24gPSAwO1xuICAgICAgICBzd2l0Y2ggKGNyaXRlcmlvbikge1xuICAgICAgICAgICAgY2FzZSAnZmlsZU5hbWUnOlxuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBhLmJhc2VuYW1lLmxvY2FsZUNvbXBhcmUoYi5iYXNlbmFtZSwgdW5kZWZpbmVkLCB7IG51bWVyaWM6IHRydWUsIHNlbnNpdGl2aXR5OiAnYmFzZScgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdsYXN0TW9kaWZpZWQnOlxuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBhLnN0YXQubXRpbWUgLSBiLnN0YXQubXRpbWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdjcmVhdGVkJzpcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gYS5zdGF0LmN0aW1lIC0gYi5zdGF0LmN0aW1lO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvcmRlciA9PT0gJ2FzYycgPyBjb21wYXJpc29uIDogLWNvbXBhcmlzb247XG4gICAgfSk7XG59XG4iLCAiLy8gc3JjL3VpL3NldHRpbmdzVGFiLnRzXG5cbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBDYXJkTmF2aWdhdG9yUGx1Z2luIGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgRm9sZGVyU3VnZ2VzdE1vZGFsIH0gZnJvbSAnLi90b29sYmFyL3Rvb2xiYXJBY3Rpb25zJztcbmltcG9ydCB7IFNvcnRDcml0ZXJpb24sIENhcmROYXZpZ2F0b3JTZXR0aW5ncyB9IGZyb20gJy4uL2NvbW1vbi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHByaXZhdGUgcGx1Z2luOiBDYXJkTmF2aWdhdG9yUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIGNvbnN0IGNyZWF0ZVNldHRpbmcgPSAobmFtZTogc3RyaW5nLCBkZXNjOiBzdHJpbmcsIHNldHRpbmdLZXk6IGtleW9mIENhcmROYXZpZ2F0b3JTZXR0aW5ncykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKG5hbWUpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoZGVzYyk7XG4gICAgICAgIH07XG5cblx0XHRjb25zdCB1cGRhdGVTZXR0aW5nID0gYXN5bmMgPEsgZXh0ZW5kcyBrZXlvZiBDYXJkTmF2aWdhdG9yU2V0dGluZ3M+KFxuICAgICAgICAgICAgc2V0dGluZ0tleTogSyxcbiAgICAgICAgICAgIHZhbHVlOiBDYXJkTmF2aWdhdG9yU2V0dGluZ3NbS11cbiAgICAgICAgKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5nc1tzZXR0aW5nS2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi50cmlnZ2VyUmVmcmVzaCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNyZWF0ZVNldHRpbmcoJ0NhcmRzIHBlciB2aWV3JywgJ051bWJlciBvZiBjYXJkcyB0byBkaXNwbGF5IGF0IG9uY2UnLCAnY2FyZHNQZXJWaWV3JylcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuICAgICAgICAgICAgICAgIC5zZXRMaW1pdHMoMSwgMTAsIDEpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRzUGVyVmlldylcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZygnY2FyZHNQZXJWaWV3JywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBjcmVhdGVTZXR0aW5nKCdGb2xkZXIgU2VsZWN0aW9uJywgJ0Nob29zZSB3aGV0aGVyIHRvIHVzZSB0aGUgYWN0aXZlIGZpbGVcXCdzIGZvbGRlciBvciBhIHNlbGVjdGVkIGZvbGRlcicsICd1c2VTZWxlY3RlZEZvbGRlcicpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdhY3RpdmUnLCAnQWN0aXZlIEZpbGVcXCdzIEZvbGRlcicpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignc2VsZWN0ZWQnLCAnU2VsZWN0ZWQgRm9sZGVyJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlU2VsZWN0ZWRGb2xkZXIgPyAnc2VsZWN0ZWQnIDogJ2FjdGl2ZScpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVTZXR0aW5nKCd1c2VTZWxlY3RlZEZvbGRlcicsIHZhbHVlID09PSAnc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTZWxlY3RlZEZvbGRlcikge1xuICAgICAgICAgICAgY3JlYXRlU2V0dGluZygnU2VsZWN0IEZvbGRlcicsICdDaG9vc2UgYSBmb2xkZXIgZm9yIENhcmQgTmF2aWdhdG9yJywgJ3NlbGVjdGVkRm9sZGVyJylcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRGb2xkZXIgfHwgJ0Nob29zZSBmb2xkZXInKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgRm9sZGVyU3VnZ2VzdE1vZGFsKHRoaXMucGx1Z2luLCBhc3luYyAoZm9sZGVyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZygnc2VsZWN0ZWRGb2xkZXInLCBmb2xkZXIucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNyZWF0ZVNldHRpbmcoJ0RlZmF1bHQgc29ydCBtZXRob2QnLCAnQ2hvb3NlIHRoZSBkZWZhdWx0IHNvcnRpbmcgbWV0aG9kIGZvciBjYXJkcycsICdzb3J0Q3JpdGVyaW9uJylcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG4gICAgICAgICAgICAgICAgZHJvcGRvd25cbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZmlsZU5hbWVfYXNjJywgJ0ZpbGUgbmFtZSAoQSB0byBaKScpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2ZpbGVOYW1lX2Rlc2MnLCAnRmlsZSBuYW1lIChaIHRvIEEpJylcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbGFzdE1vZGlmaWVkX2Rlc2MnLCAnTGFzdCBtb2RpZmllZCAobmV3ZXN0IGZpcnN0KScpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2xhc3RNb2RpZmllZF9hc2MnLCAnTGFzdCBtb2RpZmllZCAob2xkZXN0IGZpcnN0KScpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2NyZWF0ZWRfZGVzYycsICdDcmVhdGVkIChuZXdlc3QgZmlyc3QpJylcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignY3JlYXRlZF9hc2MnLCAnQ3JlYXRlZCAob2xkZXN0IGZpcnN0KScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5zb3J0Q3JpdGVyaW9ufV8ke3RoaXMucGx1Z2luLnNldHRpbmdzLnNvcnRPcmRlcn1gKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbY3JpdGVyaW9uLCBvcmRlcl0gPSB2YWx1ZS5zcGxpdCgnXycpIGFzIFtTb3J0Q3JpdGVyaW9uLCAnYXNjJyB8ICdkZXNjJ107XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVTZXR0aW5nKCdzb3J0Q3JpdGVyaW9uJywgY3JpdGVyaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVNldHRpbmcoJ3NvcnRPcmRlcicsIG9yZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBjcmVhdGVTZXR0aW5nKCdGaXhlZCBDYXJkIEhlaWdodCcsICdJZiBlbmFibGVkLCBhbGwgY2FyZHMgd2lsbCBoYXZlIHRoZSBzYW1lIGhlaWdodC4gSWYgZGlzYWJsZWQsIGNhcmQgaGVpZ2h0IHdpbGwgYWRqdXN0IHRvIGNvbnRlbnQuJywgJ2ZpeGVkQ2FyZEhlaWdodCcpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZml4ZWRDYXJkSGVpZ2h0KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZygnZml4ZWRDYXJkSGVpZ2h0JywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBjcmVhdGVTZXR0aW5nKCdSZW5kZXIgQ29udGVudCBhcyBIVE1MJywgJ0lmIGVuYWJsZWQsIGNhcmQgY29udGVudCB3aWxsIGJlIHJlbmRlcmVkIGFzIEhUTUwnLCAncmVuZGVyQ29udGVudEFzSHRtbCcpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVuZGVyQ29udGVudEFzSHRtbClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVNldHRpbmcoJ3JlbmRlckNvbnRlbnRBc0h0bWwnLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGNyZWF0ZVNldHRpbmcoJ0NlbnRlciBBY3RpdmUgQ2FyZCBvbiBPcGVuJywgJ0F1dG9tYXRpY2FsbHkgY2VudGVyIHRoZSBhY3RpdmUgY2FyZCB3aGVuIG9wZW5pbmcgdGhlIENhcmQgTmF2aWdhdG9yJywgJ2NlbnRlckFjdGl2ZUNhcmRPbk9wZW4nKVxuXHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNlbnRlckFjdGl2ZUNhcmRPbk9wZW4pXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNlbnRlckFjdGl2ZUNhcmRPbk9wZW4gPSB2YWx1ZTtcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR9KSk7XG5cbiAgICAgICAgY3JlYXRlU2V0dGluZygnQ2VudGVyIENhcmQgTWV0aG9kJywgJ0Nob29zZSBob3cgdG8gY2VudGVyIHRoZSBhY3RpdmUgY2FyZCBpbiB0aGUgdmlldycsICdjZW50ZXJDYXJkTWV0aG9kJylcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3Njcm9sbCcsICdTY3JvbGwgdG8gYWN0aXZlIGNhcmQnKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2NlbnRlcmVkJywgJ1JlbmRlciB0aGUgYWN0aXZlIGNhcmQgY2VudGVyZWQnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jZW50ZXJDYXJkTWV0aG9kKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZygnY2VudGVyQ2FyZE1ldGhvZCcsIHZhbHVlIGFzICdzY3JvbGwnIHwgJ2NlbnRlcmVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuY2VudGVyQ2FyZE1ldGhvZCA9PT0gJ2NlbnRlcmVkJykge1xuICAgICAgICAgICAgY3JlYXRlU2V0dGluZygnQW5pbWF0aW9uIER1cmF0aW9uJywgJ1NldCB0aGUgZHVyYXRpb24gb2YgdGhlIGNhcmQgYW5pbWF0aW9uIChpbiBtaWxsaXNlY29uZHMpJywgJ2FuaW1hdGlvbkR1cmF0aW9uJylcbiAgICAgICAgICAgICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgICAgICAgICAgICAgLnNldExpbWl0cygwLCAxMDAwLCA1MClcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmFuaW1hdGlvbkR1cmF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVTZXR0aW5nKCdhbmltYXRpb25EdXJhdGlvbicsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgY3JlYXRlU2V0dGluZygnRHJhZyBhbmQgRHJvcCBDb250ZW50JywgJ1doZW4gZW5hYmxlZCwgZHJhZ2dpbmcgYSBjYXJkIHdpbGwgaW5zZXJ0IHRoZSBub3RlIGNvbnRlbnQgaW5zdGVhZCBvZiBhIGxpbmsuJywgJ2RyYWdEcm9wQ29udGVudCcpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZHJhZ0Ryb3BDb250ZW50KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZygnZHJhZ0Ryb3BDb250ZW50JywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdEaXNwbGF5IGl0ZW1zIFNldHRpbmdzJyB9KTtcblxuICAgICAgICBjb25zdCBkaXNwbGF5U2V0dGluZ3MgPSBbXG4gICAgICAgICAgICB7IG5hbWU6ICdTaG93IEZpbGUgTmFtZScsIGtleTogJ3Nob3dGaWxlTmFtZScgfSxcbiAgICAgICAgICAgIHsgbmFtZTogJ1Nob3cgRmlyc3QgSGVhZGVyJywga2V5OiAnc2hvd0ZpcnN0SGVhZGVyJyB9LFxuICAgICAgICAgICAgeyBuYW1lOiAnU2hvdyBDb250ZW50Jywga2V5OiAnc2hvd0NvbnRlbnQnIH0sXG4gICAgICAgIF0gYXMgY29uc3Q7XG5cbiAgICAgICAgZGlzcGxheVNldHRpbmdzLmZvckVhY2goKHsgbmFtZSwga2V5IH0pID0+IHtcbiAgICAgICAgICAgIGNyZWF0ZVNldHRpbmcobmFtZSwgYFRvZ2dsZSB0byBkaXNwbGF5IG9yIGhpZGUgdGhlICR7bmFtZS50b0xvd2VyQ2FzZSgpfSBvbiBjYXJkc2AsIGtleSlcbiAgICAgICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzW2tleV0pXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVNldHRpbmcoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZm9udFNpemVTZXR0aW5ncyA9IFtcbiAgICAgICAgICAgIHsgbmFtZTogJ0ZpbGUgTmFtZSBTaXplJywga2V5OiAnZmlsZU5hbWVTaXplJywgbWluOiAxNSwgbWF4OiAyNSB9LFxuICAgICAgICAgICAgeyBuYW1lOiAnRmlyc3QgSGVhZGVyIFNpemUnLCBrZXk6ICdmaXJzdEhlYWRlclNpemUnLCBtaW46IDE1LCBtYXg6IDI1IH0sXG4gICAgICAgICAgICB7IG5hbWU6ICdDb250ZW50IFNpemUnLCBrZXk6ICdjb250ZW50U2l6ZScsIG1pbjogMTAsIG1heDogMjAgfSxcbiAgICAgICAgXSBhcyBjb25zdDtcblxuICAgICAgICBmb250U2l6ZVNldHRpbmdzLmZvckVhY2goKHsgbmFtZSwga2V5LCBtaW4sIG1heCB9KSA9PiB7XG4gICAgICAgICAgICBjcmVhdGVTZXR0aW5nKG5hbWUsIGBTZXQgdGhlIGZvbnQgc2l6ZSBmb3IgdGhlICR7bmFtZS50b0xvd2VyQ2FzZSgpfWAsIGtleSlcbiAgICAgICAgICAgICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgICAgICAgICAgICAgLnNldExpbWl0cyhtaW4sIG1heCwgMSlcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzW2tleV0pXG4gICAgICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVNldHRpbmcoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY3JlYXRlU2V0dGluZygnQ29udGVudCBMZW5ndGgnLCAnTWF4aW11bSBjb250ZW50IGxlbmd0aCBkaXNwbGF5ZWQgb24gZWFjaCBjYXJkJywgJ2NvbnRlbnRMZW5ndGgnKVxuICAgICAgICAgICAgLmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXG4gICAgICAgICAgICAgICAgLnNldExpbWl0cygxLCAxMCwgMSlcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudExlbmd0aClcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlU2V0dGluZygnY29udGVudExlbmd0aCcsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxufVxuIiwgIi8vIHNyYy9jb21tb24vc2V0dGluZ3MudHNcblxuaW1wb3J0IHsgQ2FyZE5hdmlnYXRvclNldHRpbmdzLCBTb3J0Q3JpdGVyaW9uIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBDYXJkTmF2aWdhdG9yU2V0dGluZ3MgPSB7XG4gICAgY2FyZHNQZXJWaWV3OiA2LFxuXHR1c2VTZWxlY3RlZEZvbGRlcjogZmFsc2UsXG4gICAgc2VsZWN0ZWRGb2xkZXI6IG51bGwsXG5cdHNvcnRDcml0ZXJpb246ICdmaWxlTmFtZScgYXMgU29ydENyaXRlcmlvbixcbiAgICBzb3J0T3JkZXI6ICdhc2MnIGFzICdhc2MnIHwgJ2Rlc2MnLFxuXHRmaXhlZENhcmRIZWlnaHQ6IHRydWUsXG5cdHJlbmRlckNvbnRlbnRBc0h0bWw6IGZhbHNlLFxuXHRjZW50ZXJBY3RpdmVDYXJkT25PcGVuOiB0cnVlLFxuXHRjZW50ZXJDYXJkTWV0aG9kOiAnc2Nyb2xsJyxcblx0YW5pbWF0aW9uRHVyYXRpb246IDMwMCxcblx0Y2VudGVyQWN0aXZlQ2FyZEhvdGtleTogeyBtb2RpZmllcnM6IFtcIkN0cmxcIiwgXCJNb2RcIl0sIGtleTogXCJIb21lXCIgfSxcblx0YWN0aXZlQ2FyZEJvcmRlckNvbG9yOiAndmFyKC0tYWN0aXZlLWJvcmRlci1jb2xvciknLFxuICAgIGFjdGl2ZUNhcmRCYWNrZ3JvdW5kQ29sb3I6ICd2YXIoLS1hY3RpdmUtYmFja2dyb3VuZC1jb2xvciknLFxuXHRkcmFnRHJvcENvbnRlbnQ6IGZhbHNlLFxuICAgIHNob3dGaWxlTmFtZTogdHJ1ZSxcbiAgICBmaWxlTmFtZVNpemU6IDIwLFxuICAgIHNob3dGaXJzdEhlYWRlcjogdHJ1ZSxcbiAgICBmaXJzdEhlYWRlclNpemU6IDE4LFxuICAgIHNob3dDb250ZW50OiB0cnVlLFxuICAgIGNvbnRlbnRTaXplOiAxNSxcbiAgICBjb250ZW50TGVuZ3RoOiA1LFxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQSxJQUFBQSxtQkFBd0M7OztBQ0F4QyxJQUFBQyxtQkFBd0M7OztBQ0F4QyxJQUFBQyxtQkFBMkM7OztBQ0EzQyxzQkFBMkM7QUFJcEMsSUFBTSxxQkFBTixjQUFpQyxrQ0FBMkI7QUFBQSxFQUMvRCxZQUFvQixRQUFxQyxVQUFxQztBQUMxRixVQUFNLE9B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VSxnQkFBZ0Isd0JBQXdCLEVBQUUsQ0FBQyxNQUE5RCxtQkFBaUU7QUFDOUUsUUFBSSxNQUFNO0FBQ04sV0FBSyxjQUFjLGFBQWEsYUFBYTtBQUFBLElBQ2pEO0FBQUEsRUFDSjtBQUFBLEVBRUEsVUFBVSxXQUEwQixPQUF1QjtBQTVKL0Q7QUE2SlEsVUFBTSxRQUFPLFVBQUssSUFBSSxVQUFVLGdCQUFnQix3QkFBd0IsRUFBRSxDQUFDLE1BQTlELG1CQUFpRTtBQUM5RSxRQUFJLE1BQU07QUFDTixXQUFLLGNBQWMsVUFBVSxXQUFXLEtBQUs7QUFBQSxJQUNqRDtBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLEVBQUUsVUFBVSxJQUFJLEtBQUs7QUFDM0IsUUFBSSxPQUFPLFVBQVUsZ0JBQWdCLHdCQUF3QixFQUFFLENBQUM7QUFFaEUsUUFBSSxDQUFDLE1BQU07QUFDUCxZQUFNLFlBQVksVUFBVSxhQUFhLEtBQUs7QUFDOUMsVUFBSSxXQUFXO0FBQ1gsY0FBTSxVQUFVLGFBQWEsRUFBRSxNQUFNLDBCQUEwQixRQUFRLEtBQUssQ0FBQztBQUM3RSxlQUFPLFVBQVUsZ0JBQWdCLHdCQUF3QixFQUFFLENBQUM7QUFBQSxNQUNoRTtBQUFBLElBQ0o7QUFFQSxRQUFJLE1BQU07QUFDTixnQkFBVSxXQUFXLElBQUk7QUFBQSxJQUM3QjtBQUFBLEVBQ0o7QUFBQSxFQUVBLGlCQUFpQjtBQUNiLFNBQUssaUJBQWlCO0FBQUEsRUFDMUI7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
